import{_ as e,c as p,d as n,a as s,b as l,e as a,r as h,o as r}from"./app-nJSYOaSR.js";const k={};function m(d,i){const t=h("ImageCard");return r(),p("div",null,[i[0]||(i[0]=n('<h2 id="targetdiff-æ¦‚è¿°" tabindex="-1"><a class="header-anchor" href="#targetdiff-æ¦‚è¿°"><span><strong>TargetDiff æ¦‚è¿°</strong></span></a></h2><h3 id="targetdiff-åœ¨å¹²ä»€ä¹ˆ" tabindex="-1"><a class="header-anchor" href="#targetdiff-åœ¨å¹²ä»€ä¹ˆ"><span><strong>TargetDiff åœ¨å¹²ä»€ä¹ˆ</strong></span></a></h3><p>TargetDiffæ˜¯ä¸€ç§åŸºäºä¸‰ç»´ç­‰å˜æ‰©æ•£æ¨¡å‹çš„åˆ†å­ç”Ÿæˆå·¥å…·ï¼Œä¸“æ³¨äºç›®æ ‡è›‹ç™½æ„ŸçŸ¥çš„åˆ†å­è®¾è®¡å’Œç»“åˆäº²å’ŒåŠ›é¢„æµ‹ï¼Œæ—¨åœ¨åŠ é€Ÿè¯ç‰©å‘ç°è¿›ç¨‹ã€‚å…¶æ ¸å¿ƒåº”ç”¨åŒ…æ‹¬ï¼š</p><ol><li><p><mark class="note"><strong>é¶å‘åˆ†å­ç”Ÿæˆï¼šæ ¹æ®ç›®æ ‡è›‹ç™½çš„ä¸‰ç»´ç»“åˆå£è¢‹ç»“æ„ï¼Œç”Ÿæˆä¸ä¹‹ç©ºé—´åŒ¹é…ä¸”å…·æœ‰é«˜ç»“åˆäº²å’ŒåŠ›çš„å€™é€‰åˆ†å­ï¼ˆä¾‹å¦‚å°åˆ†å­é…ä½“ï¼‰</strong></mark></p></li><li><p><mark class="note"><strong>ç»“åˆäº²å’ŒåŠ›é¢„æµ‹</strong>ï¼šé€šè¿‡æ— ç›‘ç£ç‰¹å¾æå–ï¼Œæä¾›åˆ†å­ä¸é¶ç‚¹è›‹ç™½çš„ç»“åˆå¼ºåº¦ä¼°è®¡ï¼Œè¾…åŠ©è¯ç‰©ç­›é€‰</mark></p></li><li><p>åˆ†å­ç»“æ„ä¼˜åŒ–ï¼šç”Ÿæˆå…·æœ‰åˆç†ä¸‰ç»´æ„è±¡çš„åˆ†å­ï¼Œé¿å…ä¼ ç»Ÿæ–¹æ³•ï¼ˆå¦‚è‡ªå›å½’æ¨¡å‹ï¼‰å› é€æ­¥ç”Ÿæˆå¯¼è‡´çš„å‡ ä½•å¤±çœŸé—®é¢˜</p></li></ol><h3 id="targetdiff-è§£å†³çš„é—®é¢˜" tabindex="-1"><a class="header-anchor" href="#targetdiff-è§£å†³çš„é—®é¢˜"><span><strong>TargetDiff è§£å†³çš„é—®é¢˜</strong></span></a></h3><table><thead><tr><th>ğŸš€ é—®é¢˜ç±»åˆ«</th><th>âŒ ä¼ ç»Ÿæ–¹æ³•çš„å±€é™</th><th>âœ… TargetDiff çš„è§£å†³æ–¹æ¡ˆ</th></tr></thead><tbody><tr><td><strong>å‡ ä½•çº¦æŸå»ºæ¨¡ä¸è¶³</strong></td><td>ğŸš¨ åŸºäºä½“ç´ åŒ–å¯†åº¦æˆ–è‡ªå›å½’é‡‡æ ·ï¼Œå¸¸ç”Ÿæˆä¸åˆç†çš„é”®é•¿ã€é”®è§’ï¼Œåˆšæ€§ç‰‡æ®µï¼ˆå¦‚è‹¯ç¯ï¼‰æ˜“æ‰­æ›²ï¼Œç»“æ„å¤±çœŸ</td><td>âœ¨ é‡‡ç”¨ <strong>SE(3)-ç­‰å˜æ‰©æ•£æ¨¡å‹</strong>ï¼Œä¿è¯ç”Ÿæˆç»“æ„åœ¨æ—‹è½¬/å¹³ç§»ä¸‹å‡ ä½•ä¸€è‡´ï¼Œè‡ªåŠ¨å¯¹é½ç»“åˆä½ç‚¹ï¼Œé¿å…å¤±çœŸ</td></tr><tr><td><strong>ä¸‰ç»´ç­‰å˜æ€§ç¼ºå¤±</strong></td><td>ğŸš¨ å¿½ç•¥åˆ†å­ä¸é¶ç‚¹ä¹‹é—´çš„ç›¸å¯¹ç©ºé—´å…³ç³»ï¼Œç”Ÿæˆæ„è±¡ä¸è›‹ç™½ç»“åˆå£è¢‹åŒ¹é…æ€§å·®</td><td>âœ¨ åˆ©ç”¨ <strong>ç­‰å˜ç¥ç»ç½‘ç»œ</strong> å»ºæ¨¡ï¼Œå¤©ç„¶ä¿æŒä¸‰ç»´æ—‹è½¬ã€å¹³ç§»ç­‰å˜æ€§ï¼Œæé«˜ç»“åˆæ„è±¡çš„ç©ºé—´åˆç†æ€§</td></tr><tr><td><strong>æ ‡æ³¨æ•°æ®ä¾èµ–æ€§å¼º</strong></td><td>ğŸš¨ äº²å’ŒåŠ›é¢„æµ‹ä¾èµ–å¤§é‡æ ‡æ³¨æ•°æ®ï¼Œæ•°æ®æ˜‚è´µä¸”éš¾ä»¥è·å–</td><td>âœ¨ é€šè¿‡ <strong>æ— ç›‘ç£å­¦ä¹ æå–åˆ†å­-é¶ç‚¹å¤åˆç‰©çš„éšå«è¡¨ç¤º</strong>ï¼Œé™ä½å¯¹ç›‘ç£æ•°æ®ä¾èµ–</td></tr><tr><td><strong>ç”Ÿæˆæ•ˆç‡ä½ä¸‹</strong></td><td>ğŸš¨ è‡ªå›å½’æ–¹æ³•éœ€é€æ­¥ç”ŸæˆåŸå­ï¼Œéšåˆ†å­å°ºå¯¸å¢é•¿æ—¶é—´æˆæœ¬å¿«é€Ÿä¸Šå‡</td><td>âœ¨ <strong>æ‰©æ•£æ¨¡å‹å¹¶è¡Œç”Ÿæˆæ‰€æœ‰åŸå­</strong>ï¼Œæ˜¾è‘—æå‡å¤§åˆ†å­ç”Ÿæˆæ•ˆç‡</td></tr><tr><td><strong>ä½ç½®ä¸ç±»å‹åˆ†ç¦»ç”Ÿæˆ</strong></td><td>ğŸš¨ åŸå­ä½ç½®ä¸ç±»å‹åˆ†ç¦»ç”Ÿæˆï¼Œå¯èƒ½å¯¼è‡´ç‰©ç†ç»“æ„ä¸ä¸€è‡´</td><td>âœ¨ é€šè¿‡ <strong>è”åˆç”Ÿæˆåæ ‡ä¸ç±»å‹</strong> çš„æ‰©æ•£æµç¨‹ï¼ŒåŒæ—¶ä¼˜åŒ–ç»“æ„å’Œç±»å‹ï¼Œå¢å¼ºç‰©ç†åˆç†æ€§</td></tr><tr><td><strong>åŠŸèƒ½å•ä¸€ï¼Œæ³›åŒ–å¼±</strong></td><td>ğŸš¨ å¤§å¤šæ•°æ¨¡å‹ä»…ç”¨äºç”Ÿæˆæˆ–é¢„æµ‹ï¼Œç‰¹å¾æ³›åŒ–èƒ½åŠ›å¼±</td><td>âœ¨ TargetDiff åŒæ—¶ä½œä¸º <strong>åˆ†å­ç”Ÿæˆå™¨ + æ— ç›‘ç£ç‰¹å¾æå–å™¨</strong>ï¼Œç”¨äºç»“åˆäº²å’ŒåŠ›æ’åä¸é¢„æµ‹ï¼Œæ•ˆæœè¶…è¶ŠEGNN</td></tr><tr><td><strong>è¯„ä¼°æ ‡å‡†ä¸å…¨é¢</strong></td><td>ğŸš¨ ä¼ ç»Ÿè¯„ä¼°æŒ‡æ ‡å¦‚ RMSD æˆ– Tanimoto ä¸èƒ½å…¨é¢åæ˜ ä¸‰ç»´æ„è±¡è´¨é‡</td><td>âœ¨ å¼•å…¥ <strong>åˆšæ€§ç‰‡æ®µä¸€è‡´æ€§ RMSD</strong> å’Œ <strong>é”®è· JS æ•£åº¦</strong> ç­‰æ–°æŒ‡æ ‡ï¼Œæ›´å¥½é‡åŒ–ç»“æ„çœŸå®æ€§ä¸ç‰©ç†åˆç†æ€§</td></tr></tbody></table><h3 id="targetdiff-å°šæœªè§£å†³çš„é—®é¢˜" tabindex="-1"><a class="header-anchor" href="#targetdiff-å°šæœªè§£å†³çš„é—®é¢˜"><span><strong>TargetDiff å°šæœªè§£å†³çš„é—®é¢˜</strong></span></a></h3><ol><li><p><mark class="danger"><strong>åŒ–å­¦é”®ç”Ÿæˆçš„ä¾èµ–æ€§ï¼š</strong></mark> å½“å‰æ¨¡å‹ä¾èµ–åå¤„ç†å·¥å…·ï¼ˆå¦‚OpenBabelï¼‰æ¨æ–­åŒ–å­¦é”®ï¼Œå¯èƒ½å¼•å…¥è¯¯å·®ã€‚æœªæ¥éœ€å°†é”®ç”Ÿæˆç›´æ¥çº³å…¥æ‰©æ•£è¿‡ç¨‹</p></li><li><p><mark class="danger"><strong>å¯åˆæˆæ€§ä¸è¯ç‰©ç›¸ä¼¼æ€§ä¸è¶³ï¼š</strong></mark> åœ¨QEDï¼ˆè¯ç‰©ç›¸ä¼¼æ€§ï¼‰å’ŒSAï¼ˆå¯åˆæˆæ€§ï¼‰è¯„åˆ†ä¸Šè½åäºPocket2Molï¼Œéœ€é€šè¿‡ <mark class="note"><strong>ç‰‡æ®µç”ŸæˆæŠ€æœ¯ä¼˜åŒ–åˆ†å­å­ç»“æ„</strong></mark></p></li><li><p><mark class="danger"><strong>ç«‹ä½“å†²çªé—®é¢˜ï¼š</strong></mark> ç”Ÿæˆçš„åˆ†å­å¯èƒ½ <mark class="warning"><strong>å› åŸå­é—´è·è¿‡è¿‘å¯¼è‡´ç«‹ä½“å†²çªï¼ˆclashï¼‰</strong></mark>ï¼Œéœ€ <mark class="note"><strong>å¼•å…¥æœ€å°è·ç¦»çº¦æŸæˆ–åå¤„ç†ä¼˜åŒ–</strong></mark></p></li><li><p>é‡‡æ ·é€Ÿåº¦ä¸ç²¾åº¦æƒè¡¡ï¼š åŸå§‹DDPMé‡‡æ ·éœ€1000æ­¥ï¼Œè™½å¯é€šè¿‡DPM-Solver++åŠ é€Ÿè‡³10æ­¥ï¼Œä½†å¯èƒ½ç‰ºç‰²ç»“åˆäº²å’ŒåŠ›ï¼›éœ€è¿›ä¸€æ­¥ä¼˜åŒ–é‡‡æ ·ç®—æ³•</p></li><li><p>å¤šç›®æ ‡ä¼˜åŒ–æŒ‘æˆ˜ï¼š åœ¨åŒæ—¶ä¼˜åŒ–ç»“åˆäº²å’ŒåŠ›ã€è¯ç‰©ç›¸ä¼¼æ€§å’Œå¤šæ ·æ€§æ—¶å­˜åœ¨æƒè¡¡ï¼ˆå¦‚ALIDIFFå®éªŒæ˜¾ç¤ºä½ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Î²</mi></mrow><annotation encoding="application/x-tex">\\beta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">Î²</span></span></span></span> å€¼å¢å¼ºäº²å’ŒåŠ›ä½†é™ä½ QEDï¼‰</p></li></ol><h2 id="targetdiff-ç†è®º" tabindex="-1"><a class="header-anchor" href="#targetdiff-ç†è®º"><span><strong>TargetDiff ç†è®º</strong></span></a></h2><h3 id="targetdiff-åŸç†ç®€è¿°" tabindex="-1"><a class="header-anchor" href="#targetdiff-åŸç†ç®€è¿°"><span><strong>TargetDiff åŸç†ç®€è¿°</strong></span></a></h3><h4 id="ç”Ÿæˆæ¨¡å‹" tabindex="-1"><a class="header-anchor" href="#ç”Ÿæˆæ¨¡å‹"><span><strong>ç”Ÿæˆæ¨¡å‹</strong></span></a></h4><ul><li>å­¦ä¹ ä¸€ä¸ªåˆ†å¸ƒ distribution â€”â€” å¦‚ä½•å­¦ä¹ ï¼Ÿ <ul><li>å·²çŸ¥ä¸€ä¸ªç®€å•çš„åˆ†å¸ƒï¼ˆé«˜æ–¯åˆ†å¸ƒã€å‡åŒ€åˆ†å¸ƒ...ï¼‰ï¼Œä»ä¸­é‡‡æ ·ï¼ˆsampleï¼‰<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>z</mi></mrow><annotation encoding="application/x-tex">z</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span></span></span></span></li><li>åˆ©ç”¨ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>N</mi><mi>e</mi><mi>t</mi><mi>w</mi><mi>o</mi><mi>r</mi><mi>k</mi><mtext>Â </mtext><mi>G</mi></mrow><annotation encoding="application/x-tex">Network\\ G</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.10903em;">N</span><span class="mord mathnormal">e</span><span class="mord mathnormal" style="margin-right:0.02691em;">tw</span><span class="mord mathnormal" style="margin-right:0.02778em;">or</span><span class="mord mathnormal" style="margin-right:0.03148em;">k</span><span class="mspace">Â </span><span class="mord mathnormal">G</span></span></span></span> å°†ç®€å•åˆ†å¸ƒæ˜ å°„åˆ°ä¸€ä¸ªå¤æ‚åˆ†å¸ƒ</li><li>ç”Ÿæˆæ ·æœ¬ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>G</mi><mo stretchy="false">(</mo><mi>z</mi><mo stretchy="false">)</mo><mo>=</mo><mi>y</mi></mrow><annotation encoding="application/x-tex">G(z)=y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">G</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.04398em;">z</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span>ï¼Œ<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span> è¿‘ä¼¼äºå¤æ‚åˆ†å¸ƒï¼ˆæˆ‘ä»¬æ— æ³•ä»å¤æ‚åˆ†å¸ƒä¸­ç›´æ¥é‡‡æ ·ï¼‰</li></ul></li><li>åˆ©ç”¨å­¦ä¹ åˆ°çš„åˆ†å¸ƒï¼Œä»ä¸­é‡‡æ ·å¾—åˆ°ç»“æœ</li></ul><h4 id="ddpm" tabindex="-1"><a class="header-anchor" href="#ddpm"><span><strong>DDPM</strong></span></a></h4><h5 id="denoising-diffusion-probabilistic-models-å»å™ªæ‰©æ•£æ¦‚ç‡æ¨¡å‹" tabindex="-1"><a class="header-anchor" href="#denoising-diffusion-probabilistic-models-å»å™ªæ‰©æ•£æ¦‚ç‡æ¨¡å‹"><span><strong>Denoising Diffusion Probabilistic Models å»å™ªæ‰©æ•£æ¦‚ç‡æ¨¡å‹</strong></span></a></h5><h5 id="æ ¸å¿ƒæ€æƒ³" tabindex="-1"><a class="header-anchor" href="#æ ¸å¿ƒæ€æƒ³"><span><strong>æ ¸å¿ƒæ€æƒ³</strong></span></a></h5><ul><li><strong>å‰å‘æ‰©æ•£è¿‡ç¨‹ï¼ˆForward Diffusion Processï¼‰</strong><ul><li>é€æ­¥åŠ å™ªï¼Œè®°å½•å™ªå£°å’Œä¸­é—´äº§ç‰©ï¼Œè®­ç»ƒç½‘ç»œé¢„æµ‹å™ªå£°</li></ul></li><li><strong>åå‘å»å™ªè¿‡ç¨‹ï¼ˆReverse Denoising Processï¼‰</strong><ul><li>ä»çº¯å™ªå£°å¼€å§‹ï¼Œé€æ­¥å»å™ªï¼Œæ¢å¤å‡ºæƒ³è¦çš„ç›®æ ‡æ•°æ®</li></ul></li></ul><h3 id="targetdiff-è®­ç»ƒç®—æ³•æµç¨‹" tabindex="-1"><a class="header-anchor" href="#targetdiff-è®­ç»ƒç®—æ³•æµç¨‹"><span><strong>TargetDiff è®­ç»ƒç®—æ³•æµç¨‹</strong></span></a></h3>',17)),i[1]||(i[1]=s("div",{class:"vp-steps"},[s("ol",null,[s("li",null,[s("p",null,"è¾“å…¥ï¼šè›‹ç™½è´¨-é…ä½“çš„ç»“åˆæ•°æ®é›†")]),s("li",null,[s("p",null,[a("æ‰©æ•£æ¡ä»¶åˆå§‹åŒ–ï¼šé‡‡æ ·æ—¶é—´æ­¥ â€”â€” ä»å‡åŒ€åˆ†å¸ƒ "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",null,"U"),s("mo",{stretchy:"false"},"("),s("mn",null,"0"),s("mo",{separator:"true"},","),s("mo",null,"â€¦"),s("mo",{separator:"true"},","),s("mi",null,"T"),s("mo",{stretchy:"false"},")")]),s("annotation",{encoding:"application/x-tex"},"U(0, \\dots, T)")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.10903em"}},"U"),s("span",{class:"mopen"},"("),s("span",{class:"mord"},"0"),s("span",{class:"mpunct"},","),s("span",{class:"mspace",style:{"margin-right":"0.1667em"}}),s("span",{class:"minner"},"â€¦"),s("span",{class:"mspace",style:{"margin-right":"0.1667em"}}),s("span",{class:"mpunct"},","),s("span",{class:"mspace",style:{"margin-right":"0.1667em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.13889em"}},"T"),s("span",{class:"mclose"},")")])])]),a(" ä¸­é‡‡æ ·æ‰©æ•£æ—¶é—´ "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",null,"t")]),s("annotation",{encoding:"application/x-tex"},"t")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6151em"}}),s("span",{class:"mord mathnormal"},"t")])])])])]),s("li",null,[s("p",null,"é¢„å¤„ç†ï¼šå°†è›‹ç™½è´¨åŸå­çš„è´¨å¿ƒç§»åŠ¨åˆ°åŸç‚¹ï¼Œä»¥å¯¹é½é…ä½“å’Œè›‹ç™½è´¨çš„ä½ç½®ï¼Œç¡®ä¿æ•°æ®åœ¨ç©ºé—´ä¸Šçš„ä¸€è‡´æ€§")]),s("li",null,[s("p",null,[a("åŠ å™ªï¼šç½‘ç»œä¸­ä¸»è¦æ˜¯é’ˆå¯¹ ä½ç½® "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",null,"x")]),s("annotation",{encoding:"application/x-tex"},"x")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.4306em"}}),s("span",{class:"mord mathnormal"},"x")])])]),a(" å’Œ åŸå­ç±»å‹ "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",null,"v")]),s("annotation",{encoding:"application/x-tex"},"v")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.4306em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"v")])])]),a(" è¿›è¡Œæ‰°åŠ¨ï¼Œé€æ­¥åŠ å™ª")]),s("ul",null,[s("li",null,[s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("msub",null,[s("mi",null,"x"),s("mi",null,"t")]),s("mo",null,"="),s("msqrt",null,[s("msub",null,[s("mover",{accent:"true"},[s("mi",null,"Î±"),s("mo",null,"Ë‰")]),s("mi",null,"t")])]),s("msub",null,[s("mi",null,"x"),s("mn",null,"0")]),s("mo",null,"+"),s("mo",{stretchy:"false"},"("),s("mn",null,"1"),s("mo",null,"âˆ’"),s("msub",null,[s("mover",{accent:"true"},[s("mi",null,"Î±"),s("mo",null,"Ë‰")]),s("mi",null,"t")]),s("mo",{stretchy:"false"},")"),s("mi",null,"Ïµ")]),s("annotation",{encoding:"application/x-tex"},"x_t = \\sqrt{\\bar{\\alpha}_t} x_0 + (1 - \\bar{\\alpha}_t) \\epsilon")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.5806em","vertical-align":"-0.15em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal"},"x"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.2806em"}},[s("span",{style:{top:"-2.55em","margin-left":"0em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mathnormal mtight"},"t")])])]),s("span",{class:"vlist-s"},"â€‹")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.15em"}},[s("span")])])])])]),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1.04em","vertical-align":"-0.2461em"}}),s("span",{class:"mord sqrt"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.7939em"}},[s("span",{class:"svg-align",style:{top:"-3em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"mord",style:{"padding-left":"0.833em"}},[s("span",{class:"mord"},[s("span",{class:"mord accent"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.5678em"}},[s("span",{style:{top:"-3em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.0037em"}},"Î±")]),s("span",{style:{top:"-3em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"accent-body",style:{left:"-0.2222em"}},[s("span",{class:"mord"},"Ë‰")])])])])])]),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.2806em"}},[s("span",{style:{top:"-2.55em","margin-left":"-0.0037em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mathnormal mtight"},"t")])])]),s("span",{class:"vlist-s"},"â€‹")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.15em"}},[s("span")])])])])])])]),s("span",{style:{top:"-2.7539em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"hide-tail",style:{"min-width":"0.853em",height:"1.08em"}},[s("svg",{xmlns:"http://www.w3.org/2000/svg",width:"400em",height:"1.08em",viewBox:"0 0 400000 1080",preserveAspectRatio:"xMinYMin slice"},[s("path",{d:`M95,702
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l0 -0
c5.3,-9.3,12,-14,20,-14
H400000v40H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M834 80h400000v40h-400000z`})])])])]),s("span",{class:"vlist-s"},"â€‹")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.2461em"}},[s("span")])])])]),s("span",{class:"mord"},[s("span",{class:"mord mathnormal"},"x"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.3011em"}},[s("span",{style:{top:"-2.55em","margin-left":"0em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},"0")])])]),s("span",{class:"vlist-s"},"â€‹")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.15em"}},[s("span")])])])])]),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mbin"},"+"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),s("span",{class:"mopen"},"("),s("span",{class:"mord"},"1"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mbin"},"âˆ’"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),s("span",{class:"mord"},[s("span",{class:"mord accent"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.5678em"}},[s("span",{style:{top:"-3em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.0037em"}},"Î±")]),s("span",{style:{top:"-3em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"accent-body",style:{left:"-0.2222em"}},[s("span",{class:"mord"},"Ë‰")])])])])])]),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.2806em"}},[s("span",{style:{top:"-2.55em","margin-left":"-0.0037em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mathnormal mtight"},"t")])])]),s("span",{class:"vlist-s"},"â€‹")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.15em"}},[s("span")])])])])]),s("span",{class:"mclose"},")"),s("span",{class:"mord mathnormal"},"Ïµ")])])]),a("ï¼Œå…¶ä¸­ "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",null,"Ïµ")]),s("annotation",{encoding:"application/x-tex"},"\\epsilon")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.4306em"}}),s("span",{class:"mord mathnormal"},"Ïµ")])])]),a(" Â æ˜¯ä»æ­£æ€åˆ†å¸ƒ "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",{mathvariant:"script"},"N"),s("mo",{stretchy:"false"},"("),s("mn",null,"0"),s("mo",{separator:"true"},","),s("mi",null,"I"),s("mo",{stretchy:"false"},")")]),s("annotation",{encoding:"application/x-tex"},"\\mathcal{N}(0, I)")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),s("span",{class:"mord mathcal",style:{"margin-right":"0.14736em"}},"N"),s("span",{class:"mopen"},"("),s("span",{class:"mord"},"0"),s("span",{class:"mpunct"},","),s("span",{class:"mspace",style:{"margin-right":"0.1667em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.07847em"}},"I"),s("span",{class:"mclose"},")")])])]),a(" Â ä¸­é‡‡æ ·çš„å™ªå£°")]),s("li",null,[s("p",{class:"katex-block"},[s("span",{class:"katex-display"},[s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML",display:"block"},[s("semantics",null,[s("mtable",{rowspacing:"0.25em",columnalign:"right left",columnspacing:"0em"},[s("mtr",null,[s("mtd",{class:"mtr-glue"}),s("mtd",null,[s("mstyle",{scriptlevel:"0",displaystyle:"true"},[s("mrow",null,[s("mi",null,"l"),s("mi",null,"o"),s("mi",null,"g"),s("mi",{mathvariant:"bold"},"c")])])]),s("mtd",null,[s("mstyle",{scriptlevel:"0",displaystyle:"true"},[s("mrow",null,[s("mrow"),s("mo",null,"="),s("mi",null,"log"),s("mo",null,"â¡"),s("mrow",null,[s("mo",{fence:"true"},"("),s("msub",null,[s("mover",{accent:"true"},[s("mi",null,"Î±"),s("mo",null,"Ë‰")]),s("mi",null,"t")]),s("msub",null,[s("mi",{mathvariant:"bold"},"v"),s("mn",null,"0")]),s("mo",null,"+"),s("mfrac",null,[s("mrow",null,[s("mo",{stretchy:"false"},"("),s("mn",null,"1"),s("mo",null,"âˆ’"),s("msub",null,[s("mover",{accent:"true"},[s("mi",null,"Î±"),s("mo",null,"Ë‰")]),s("mi",null,"t")]),s("mo",{stretchy:"false"},")")]),s("mi",null,"K")]),s("mo",{fence:"true"},")")])])])]),s("mtd",{class:"mtr-glue"}),s("mtd",{class:"mml-eqn-num"})]),s("mtr",null,[s("mtd",{class:"mtr-glue"}),s("mtd",null,[s("mstyle",{scriptlevel:"0",displaystyle:"true"},[s("msub",null,[s("mi",{mathvariant:"bold"},"v"),s("mi",null,"t")])])]),s("mtd",null,[s("mstyle",{scriptlevel:"0",displaystyle:"true"},[s("mrow",null,[s("mrow"),s("mo",null,"="),s("mtext",null,"one_hot"),s("mrow",null,[s("mo",{fence:"true"},"("),s("mi",null,"arg"),s("mo",null,"â¡"),s("munder",null,[s("mrow",null,[s("mi",null,"max"),s("mo",null,"â¡")]),s("mi",null,"i")]),s("mo",{stretchy:"false"},"["),s("msub",null,[s("mi",null,"g"),s("mi",null,"i")]),s("mo",null,"+"),s("mi",null,"log"),s("mo",null,"â¡"),s("msub",null,[s("mi",null,"c"),s("mi",null,"i")]),s("mo",{stretchy:"false"},"]"),s("mo",{fence:"true"},")")]),s("mo",{separator:"true"},","),s("mtext",null,"Â whereÂ "),s("mi",null,"g"),s("mo",null,"âˆ¼"),s("mtext",null,"Gumbel"),s("mo",{stretchy:"false"},"("),s("mn",null,"0"),s("mo",{separator:"true"},","),s("mn",null,"1"),s("mo",{stretchy:"false"},")")])])]),s("mtd",{class:"mtr-glue"}),s("mtd",{class:"mml-eqn-num"})])]),s("annotation",{encoding:"application/x-tex"},"\\begin{align}log \\mathbf{c} &= \\log \\left( \\bar{\\alpha}_t \\mathbf{v}_0 + \\frac{(1 - \\bar{\\alpha}_t)}{K} \\right) \\\\ \\mathbf{v}_t &= \\text{one\\_hot} \\left( \\arg \\max_i [g_i + \\log c_i] \\right), \\text{ where } g \\sim \\text{Gumbel}(0, 1)\\end{align} ")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"4.8777em","vertical-align":"-2.1888em"}}),s("span",{class:"mtable"},[s("span",{class:"col-align-r"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"2.6888em"}},[s("span",{style:{top:"-4.6888em"}},[s("span",{class:"pstrut",style:{height:"3.45em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.01968em"}},"l"),s("span",{class:"mord mathnormal"},"o"),s("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"g"),s("span",{class:"mord mathbf"},"c")])]),s("span",{style:{top:"-2.2888em"}},[s("span",{class:"pstrut",style:{height:"3.45em"}}),s("span",{class:"mord"},[s("span",{class:"mord"},[s("span",{class:"mord mathbf",style:{"margin-right":"0.01597em"}},"v"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.2806em"}},[s("span",{style:{top:"-2.55em","margin-left":"-0.016em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mathnormal mtight"},"t")])])]),s("span",{class:"vlist-s"},"â€‹")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.15em"}},[s("span")])])])])])])])]),s("span",{class:"vlist-s"},"â€‹")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"2.1888em"}},[s("span")])])])]),s("span",{class:"col-align-l"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"2.6888em"}},[s("span",{style:{top:"-4.6888em"}},[s("span",{class:"pstrut",style:{height:"3.45em"}}),s("span",{class:"mord"},[s("span",{class:"mord"}),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mop"},[a("lo"),s("span",{style:{"margin-right":"0.01389em"}},"g")]),s("span",{class:"mspace",style:{"margin-right":"0.1667em"}}),s("span",{class:"minner"},[s("span",{class:"mopen delimcenter",style:{top:"0em"}},[s("span",{class:"delimsizing size3"},"(")]),s("span",{class:"mord"},[s("span",{class:"mord accent"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.5678em"}},[s("span",{style:{top:"-3em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.0037em"}},"Î±")]),s("span",{style:{top:"-3em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"accent-body",style:{left:"-0.2222em"}},[s("span",{class:"mord"},"Ë‰")])])])])])]),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.2806em"}},[s("span",{style:{top:"-2.55em","margin-left":"-0.0037em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mathnormal mtight"},"t")])])]),s("span",{class:"vlist-s"},"â€‹")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.15em"}},[s("span")])])])])]),s("span",{class:"mord"},[s("span",{class:"mord mathbf",style:{"margin-right":"0.01597em"}},"v"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.3011em"}},[s("span",{style:{top:"-2.55em","margin-left":"-0.016em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},"0")])])]),s("span",{class:"vlist-s"},"â€‹")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.15em"}},[s("span")])])])])]),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mbin"},"+"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mord"},[s("span",{class:"mopen nulldelimiter"}),s("span",{class:"mfrac"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"1.427em"}},[s("span",{style:{top:"-2.314em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.07153em"}},"K")])]),s("span",{style:{top:"-3.23em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"frac-line",style:{"border-bottom-width":"0.04em"}})]),s("span",{style:{top:"-3.677em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"mord"},[s("span",{class:"mopen"},"("),s("span",{class:"mord"},"1"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mbin"},"âˆ’"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mord"},[s("span",{class:"mord accent"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.5678em"}},[s("span",{style:{top:"-3em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.0037em"}},"Î±")]),s("span",{style:{top:"-3em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"accent-body",style:{left:"-0.2222em"}},[s("span",{class:"mord"},"Ë‰")])])])])])]),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.2806em"}},[s("span",{style:{top:"-2.55em","margin-left":"-0.0037em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mathnormal mtight"},"t")])])]),s("span",{class:"vlist-s"},"â€‹")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.15em"}},[s("span")])])])])]),s("span",{class:"mclose"},")")])])]),s("span",{class:"vlist-s"},"â€‹")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.686em"}},[s("span")])])])]),s("span",{class:"mclose nulldelimiter"})]),s("span",{class:"mclose delimcenter",style:{top:"0em"}},[s("span",{class:"delimsizing size3"},")")])])])]),s("span",{style:{top:"-2.2888em"}},[s("span",{class:"pstrut",style:{height:"3.45em"}}),s("span",{class:"mord"},[s("span",{class:"mord"}),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mord text"},[s("span",{class:"mord"},"one_hot")]),s("span",{class:"mspace",style:{"margin-right":"0.1667em"}}),s("span",{class:"minner"},[s("span",{class:"mopen delimcenter",style:{top:"0em"}},[s("span",{class:"delimsizing size2"},"(")]),s("span",{class:"mop"},[a("ar"),s("span",{style:{"margin-right":"0.01389em"}},"g")]),s("span",{class:"mspace",style:{"margin-right":"0.1667em"}}),s("span",{class:"mop op-limits"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.4306em"}},[s("span",{style:{top:"-2.3723em","margin-left":"0em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mathnormal mtight"},"i")])]),s("span",{style:{top:"-3em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",null,[s("span",{class:"mop"},"max")])])]),s("span",{class:"vlist-s"},"â€‹")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.7277em"}},[s("span")])])])]),s("span",{class:"mopen"},"["),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"g"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.3117em"}},[s("span",{style:{top:"-2.55em","margin-left":"-0.0359em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mathnormal mtight"},"i")])])]),s("span",{class:"vlist-s"},"â€‹")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.15em"}},[s("span")])])])])]),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mbin"},"+"),s("span",{class:"mspace",style:{"margin-right":"0.2222em"}}),s("span",{class:"mop"},[a("lo"),s("span",{style:{"margin-right":"0.01389em"}},"g")]),s("span",{class:"mspace",style:{"margin-right":"0.1667em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal"},"c"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.3117em"}},[s("span",{style:{top:"-2.55em","margin-left":"0em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mathnormal mtight"},"i")])])]),s("span",{class:"vlist-s"},"â€‹")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.15em"}},[s("span")])])])])]),s("span",{class:"mclose"},"]"),s("span",{class:"mclose delimcenter",style:{top:"0em"}},[s("span",{class:"delimsizing size2"},")")])]),s("span",{class:"mspace",style:{"margin-right":"0.1667em"}}),s("span",{class:"mpunct"},","),s("span",{class:"mspace",style:{"margin-right":"0.1667em"}}),s("span",{class:"mord text"},[s("span",{class:"mord"},"Â whereÂ ")]),s("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"g"),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"âˆ¼"),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mord text"},[s("span",{class:"mord"},"Gumbel")]),s("span",{class:"mopen"},"("),s("span",{class:"mord"},"0"),s("span",{class:"mpunct"},","),s("span",{class:"mspace",style:{"margin-right":"0.1667em"}}),s("span",{class:"mord"},"1"),s("span",{class:"mclose"},")")])])]),s("span",{class:"vlist-s"},"â€‹")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"2.1888em"}},[s("span")])])])])])]),s("span",{class:"tag"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"2.6888em"}},[s("span",{style:{top:"-4.6888em"}},[s("span",{class:"pstrut",style:{height:"3.45em"}}),s("span",{class:"eqn-num"})]),s("span",{style:{top:"-2.2888em"}},[s("span",{class:"pstrut",style:{height:"3.45em"}}),s("span",{class:"eqn-num"})])]),s("span",{class:"vlist-s"},"â€‹")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"2.1888em"}},[s("span")])])])])])])])])])])]),s("li",null,[s("p",null,[a("é¢„æµ‹ï¼š"),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mo",{stretchy:"false"},"["),s("msub",null,[s("mover",{accent:"true"},[s("mi",null,"x"),s("mo",null,"^")]),s("mn",null,"0")]),s("mo",{separator:"true"},","),s("msub",null,[s("mover",{accent:"true"},[s("mi",null,"v"),s("mo",null,"^")]),s("mn",null,"0")]),s("mo",{stretchy:"false"},"]"),s("mo",null,"="),s("msub",null,[s("mi",null,"Ï•"),s("mi",null,"Î¸")]),s("mo",{stretchy:"false"},"("),s("mo",{stretchy:"false"},"["),s("mi",null,"x"),s("mi",null,"t"),s("mo",{separator:"true"},","),s("mi",null,"v"),s("mi",null,"t"),s("mo",{stretchy:"false"},"]"),s("mo",{separator:"true"},","),s("mi",null,"t"),s("mo",{separator:"true"},","),s("mi",{mathvariant:"script"},"P"),s("mo",{stretchy:"false"},")")]),s("annotation",{encoding:"application/x-tex"},"[\\hat{x}_0,\\hat{v}_0]=\\phi_\\theta([xt, vt], t, \\mathcal{P})")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),s("span",{class:"mopen"},"["),s("span",{class:"mord"},[s("span",{class:"mord accent"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.6944em"}},[s("span",{style:{top:"-3em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"mord mathnormal"},"x")]),s("span",{style:{top:"-3em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"accent-body",style:{left:"-0.2222em"}},[s("span",{class:"mord"},"^")])])])])])]),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.3011em"}},[s("span",{style:{top:"-2.55em","margin-left":"0em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},"0")])])]),s("span",{class:"vlist-s"},"â€‹")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.15em"}},[s("span")])])])])]),s("span",{class:"mpunct"},","),s("span",{class:"mspace",style:{"margin-right":"0.1667em"}}),s("span",{class:"mord"},[s("span",{class:"mord accent"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.6944em"}},[s("span",{style:{top:"-3em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"v")]),s("span",{style:{top:"-3em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"accent-body",style:{left:"-0.2222em"}},[s("span",{class:"mord"},"^")])])])])])]),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.3011em"}},[s("span",{style:{top:"-2.55em","margin-left":"-0.0359em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},"0")])])]),s("span",{class:"vlist-s"},"â€‹")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.15em"}},[s("span")])])])])]),s("span",{class:"mclose"},"]"),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}}),s("span",{class:"mrel"},"="),s("span",{class:"mspace",style:{"margin-right":"0.2778em"}})]),s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal"},"Ï•"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.3361em"}},[s("span",{style:{top:"-2.55em","margin-left":"0em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mathnormal mtight",style:{"margin-right":"0.02778em"}},"Î¸")])])]),s("span",{class:"vlist-s"},"â€‹")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.15em"}},[s("span")])])])])]),s("span",{class:"mopen"},"(["),s("span",{class:"mord mathnormal"},"x"),s("span",{class:"mord mathnormal"},"t"),s("span",{class:"mpunct"},","),s("span",{class:"mspace",style:{"margin-right":"0.1667em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"v"),s("span",{class:"mord mathnormal"},"t"),s("span",{class:"mclose"},"]"),s("span",{class:"mpunct"},","),s("span",{class:"mspace",style:{"margin-right":"0.1667em"}}),s("span",{class:"mord mathnormal"},"t"),s("span",{class:"mpunct"},","),s("span",{class:"mspace",style:{"margin-right":"0.1667em"}}),s("span",{class:"mord mathcal",style:{"margin-right":"0.08222em"}},"P"),s("span",{class:"mclose"},")")])])]),a(" ï¼Œé¢„æµ‹æ‰°åŠ¨ä½ç½®å’Œç±»å‹ï¼Œå³ "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("msub",null,[s("mover",{accent:"true"},[s("mi",null,"x"),s("mo",null,"^")]),s("mn",null,"0")])]),s("annotation",{encoding:"application/x-tex"},"\\hat{x}_0")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.8444em","vertical-align":"-0.15em"}}),s("span",{class:"mord"},[s("span",{class:"mord accent"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.6944em"}},[s("span",{style:{top:"-3em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"mord mathnormal"},"x")]),s("span",{style:{top:"-3em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"accent-body",style:{left:"-0.2222em"}},[s("span",{class:"mord"},"^")])])])])])]),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.3011em"}},[s("span",{style:{top:"-2.55em","margin-left":"0em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},"0")])])]),s("span",{class:"vlist-s"},"â€‹")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.15em"}},[s("span")])])])])])])])]),a(" Â å’Œ "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("msub",null,[s("mover",{accent:"true"},[s("mi",null,"v"),s("mo",null,"^")]),s("mn",null,"0")])]),s("annotation",{encoding:"application/x-tex"},"\\hat{v}_0")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.8444em","vertical-align":"-0.15em"}}),s("span",{class:"mord"},[s("span",{class:"mord accent"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.6944em"}},[s("span",{style:{top:"-3em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"v")]),s("span",{style:{top:"-3em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"accent-body",style:{left:"-0.2222em"}},[s("span",{class:"mord"},"^")])])])])])]),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.3011em"}},[s("span",{style:{top:"-2.55em","margin-left":"-0.0359em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},"0")])])]),s("span",{class:"vlist-s"},"â€‹")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.15em"}},[s("span")])])])])])])])]),a(" ï¼Œæ¡ä»¶æ˜¯å½“å‰çš„ "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("msub",null,[s("mi",null,"x"),s("mi",null,"t")])]),s("annotation",{encoding:"application/x-tex"},"x_t")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.5806em","vertical-align":"-0.15em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal"},"x"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.2806em"}},[s("span",{style:{top:"-2.55em","margin-left":"0em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mathnormal mtight"},"t")])])]),s("span",{class:"vlist-s"},"â€‹")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.15em"}},[s("span")])])])])])])])]),a("ã€"),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("msub",null,[s("mi",null,"v"),s("mi",null,"t")])]),s("annotation",{encoding:"application/x-tex"},"v_t")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.5806em","vertical-align":"-0.15em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"v"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.2806em"}},[s("span",{style:{top:"-2.55em","margin-left":"-0.0359em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mathnormal mtight"},"t")])])]),s("span",{class:"vlist-s"},"â€‹")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.15em"}},[s("span")])])])])])])])]),a("ã€æ—¶é—´æ­¥ "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",null,"t")]),s("annotation",{encoding:"application/x-tex"},"t")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6151em"}}),s("span",{class:"mord mathnormal"},"t")])])]),a(" å’Œè›‹ç™½è´¨ä¿¡æ¯ "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",{mathvariant:"script"},"P")]),s("annotation",{encoding:"application/x-tex"},"\\mathcal{P}")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6833em"}}),s("span",{class:"mord mathcal",style:{"margin-right":"0.08222em"}},"P")])])])])]),s("li",null,[s("p",null,[a("è®¡ç®—åéªŒç±»å‹åˆ†å¸ƒï¼šæ ¹æ®å…¬å¼è®¡ç®—åŸå­ç±»å‹çš„åéªŒåˆ†å¸ƒ "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",null,"c"),s("mo",{stretchy:"false"},"("),s("msub",null,[s("mi",null,"v"),s("mi",null,"t")]),s("mo",{separator:"true"},","),s("msub",null,[s("mi",null,"v"),s("mn",null,"0")]),s("mo",{stretchy:"false"},")")]),s("annotation",{encoding:"application/x-tex"},"c(v_t, v_0)")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),s("span",{class:"mord mathnormal"},"c"),s("span",{class:"mopen"},"("),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"v"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.2806em"}},[s("span",{style:{top:"-2.55em","margin-left":"-0.0359em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mathnormal mtight"},"t")])])]),s("span",{class:"vlist-s"},"â€‹")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.15em"}},[s("span")])])])])]),s("span",{class:"mpunct"},","),s("span",{class:"mspace",style:{"margin-right":"0.1667em"}}),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"v"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.3011em"}},[s("span",{style:{top:"-2.55em","margin-left":"-0.0359em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},"0")])])]),s("span",{class:"vlist-s"},"â€‹")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.15em"}},[s("span")])])])])]),s("span",{class:"mclose"},")")])])]),a(" å’Œ "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",null,"c"),s("mo",{stretchy:"false"},"("),s("msub",null,[s("mi",null,"v"),s("mi",null,"t")]),s("mo",{separator:"true"},","),s("msub",null,[s("mover",{accent:"true"},[s("mi",null,"v"),s("mo",null,"^")]),s("mn",null,"0")]),s("mo",{stretchy:"false"},")")]),s("annotation",{encoding:"application/x-tex"},"c(v_t, \\hat{v}_0)")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"1em","vertical-align":"-0.25em"}}),s("span",{class:"mord mathnormal"},"c"),s("span",{class:"mopen"},"("),s("span",{class:"mord"},[s("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"v"),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.2806em"}},[s("span",{style:{top:"-2.55em","margin-left":"-0.0359em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mathnormal mtight"},"t")])])]),s("span",{class:"vlist-s"},"â€‹")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.15em"}},[s("span")])])])])]),s("span",{class:"mpunct"},","),s("span",{class:"mspace",style:{"margin-right":"0.1667em"}}),s("span",{class:"mord"},[s("span",{class:"mord accent"},[s("span",{class:"vlist-t"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.6944em"}},[s("span",{style:{top:"-3em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.03588em"}},"v")]),s("span",{style:{top:"-3em"}},[s("span",{class:"pstrut",style:{height:"3em"}}),s("span",{class:"accent-body",style:{left:"-0.2222em"}},[s("span",{class:"mord"},"^")])])])])])]),s("span",{class:"msupsub"},[s("span",{class:"vlist-t vlist-t2"},[s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.3011em"}},[s("span",{style:{top:"-2.55em","margin-left":"-0.0359em","margin-right":"0.05em"}},[s("span",{class:"pstrut",style:{height:"2.7em"}}),s("span",{class:"sizing reset-size6 size3 mtight"},[s("span",{class:"mord mtight"},"0")])])]),s("span",{class:"vlist-s"},"â€‹")]),s("span",{class:"vlist-r"},[s("span",{class:"vlist",style:{height:"0.15em"}},[s("span")])])])])]),s("span",{class:"mclose"},")")])])])])]),s("li",null,[s("p",null,"æŸå¤±å‡½æ•°ï¼š"),s("ul",null,[s("li",null,"å‡æ–¹è¯¯å·® MSEï¼šåº¦é‡åŸå­åæ ‡çš„åå·®"),s("li",null,"KL æ•£åº¦ï¼ˆKL-divergenceï¼‰ï¼šåº¦é‡ç±»å‹åˆ†å¸ƒçš„å·®å¼‚")])]),s("li",null,[s("p",null,[a("æ›´æ–°å‚æ•°ï¼š æœ€å°åŒ–æŸå¤±å‡½æ•° "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",null,"L")]),s("annotation",{encoding:"application/x-tex"},"L")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6833em"}}),s("span",{class:"mord mathnormal"},"L")])])]),a(" Â æ¥æ›´æ–°æ¨¡å‹å‚æ•° "),s("span",{class:"katex"},[s("span",{class:"katex-mathml"},[s("math",{xmlns:"http://www.w3.org/1998/Math/MathML"},[s("semantics",null,[s("mrow",null,[s("mi",null,"Î¸")]),s("annotation",{encoding:"application/x-tex"},"\\theta")])])]),s("span",{class:"katex-html","aria-hidden":"true"},[s("span",{class:"base"},[s("span",{class:"strut",style:{height:"0.6944em"}}),s("span",{class:"mord mathnormal",style:{"margin-right":"0.02778em"}},"Î¸")])])])])])])],-1)),l(t,{image:"https://image.velvet-notes.org/blog/train_targetdiff.png",width:"85%",center:"true"}),i[2]||(i[2]=n('<h3 id="targetdiff-é‡‡æ ·ç®—æ³•æµç¨‹" tabindex="-1"><a class="header-anchor" href="#targetdiff-é‡‡æ ·ç®—æ³•æµç¨‹"><span><strong>TargetDiff é‡‡æ ·ç®—æ³•æµç¨‹</strong></span></a></h3><div class="vp-steps"><ol><li><p>è¾“å…¥ï¼šè›‹ç™½è´¨ç»“åˆä½ç‚¹ï¼ˆbinding siteï¼‰<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">P</mi></mrow><annotation encoding="application/x-tex">\\mathcal{P}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathcal" style="margin-right:0.08222em;">P</span></span></span></span> ä¸ è®­ç»ƒå¥½çš„æ¨¡å‹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Ï•</mi><mi>Î¸</mi></msub></mrow><annotation encoding="application/x-tex">\\phi_\\theta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal">Ï•</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">Î¸</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></p></li><li><p>è¾“å‡ºï¼šç”±æ¨¡å‹ç”Ÿæˆçš„èƒ½ä¸è›‹ç™½è´¨å£è¢‹ç»“åˆçš„é…ä½“åˆ†å­ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">M</mi></mrow><annotation encoding="application/x-tex">\\mathcal{M}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathcal">M</span></span></span></span></p></li><li><p>ç¡®å®šåŸå­æ•°é‡ï¼šåŸºäºå£è¢‹å¤§å°ï¼Œä»ä¸€ä¸ªå…ˆéªŒåˆ†å¸ƒä¸­é‡‡æ ·ä¸€ä¸ªç”Ÿæˆçš„é…ä½“åˆ†å­çš„åŸå­æ•°é‡</p></li><li><p>é¢„å¤„ç†ï¼šç§»åŠ¨è›‹ç™½è´¨åŸå­çš„è´¨å¿ƒè‡³åæ ‡åŸç‚¹ï¼Œä½¿ä½ç½®æ ‡å‡†åŒ–ï¼Œä»¥ç¡®ä¿ç”Ÿæˆçš„é…ä½“ä¸è›‹ç™½è´¨ç»“åˆä½ç‚¹å¯¹é½</p></li><li><p>åˆå§‹åŒ–ï¼šé‡‡æ ·ä¸€ä¸ªåˆå§‹çš„åŸå­åæ ‡ï¼ˆcoordinatesï¼‰<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">x</mi><mi>T</mi></msub></mrow><annotation encoding="application/x-tex">\\mathbf{x}_T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5944em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> å’Œ åŸå­ç±»å‹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">v</mi><mi>T</mi></msub></mrow><annotation encoding="application/x-tex">\\mathbf{v}_T</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5944em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.016em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></p><ul><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">x</mi><mi>T</mi></msub><mo>âˆˆ</mo><mi mathvariant="script">N</mi><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mi mathvariant="bold-italic">I</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\\mathbf{x}_T \\in \\mathcal{N}(0,\\boldsymbol{I})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6891em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">âˆˆ</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathcal" style="margin-right:0.14736em;">N</span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.07778em;">I</span></span></span><span class="mclose">)</span></span></span></span> â€”â€” ä»æ ‡å‡†æ­£æ€åˆ†å¸ƒ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">N</mi><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mi mathvariant="bold-italic">I</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\\mathcal{N}(0,\\boldsymbol{I})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathcal" style="margin-right:0.14736em;">N</span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord"><span class="mord boldsymbol" style="margin-right:0.07778em;">I</span></span></span><span class="mclose">)</span></span></span></span> ä¸­é‡‡æ ·</li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">v</mi><mi>T</mi></msub><mo>=</mo><mtext>one_hot</mtext><mrow><mo fence="true">(</mo><mi>arg</mi><mo>â¡</mo><msub><mrow><mi>max</mi><mo>â¡</mo></mrow><mi>i</mi></msub><msub><mi>g</mi><mi>i</mi></msub><mo fence="true">)</mo></mrow><mo separator="true">,</mo><mtext>Â whereÂ </mtext><mi>g</mi><mo>âˆ¼</mo><mtext>Gumbel</mtext><mo stretchy="false">(</mo><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\\mathbf{v}_T = \\text{one\\_hot} \\left( \\arg \\max_i g_i \\right), \\text{ where } g \\sim \\text{Gumbel}(0, 1)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5944em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3283em;"><span style="top:-2.55em;margin-left:-0.016em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.13889em;">T</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1.06em;vertical-align:-0.31em;"></span><span class="mord text"><span class="mord">one_hot</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mop">ar<span style="margin-right:0.01389em;">g</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop"><span class="mop">max</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3117em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord text"><span class="mord">Â whereÂ </span></span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">âˆ¼</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">Gumbel</span></span><span class="mopen">(</span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mclose">)</span></span></span></span></li><li><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="bold">for</mtext><mtext>Â </mtext><mi>t</mi><mtext>Â inÂ </mtext><mi>T</mi><mo separator="true">,</mo><mi>T</mi><mo>âˆ’</mo><mn>1</mn><mo separator="true">,</mo><mo>â‹¯</mo><mtext>â€‰</mtext><mo separator="true">,</mo><mn>1</mn><mtext>Â </mtext><mtext mathvariant="bold">do</mtext></mrow><annotation encoding="application/x-tex">\\textbf{for}\\ t\\ \\text{in}\\ T,T-1,\\cdots,1\\ \\textbf{do}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord text"><span class="mord textbf">for</span></span><span class="mspace">Â </span><span class="mord mathnormal">t</span><span class="mspace">Â </span><span class="mord text"><span class="mord">in</span></span><span class="mspace">Â </span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">T</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8889em;vertical-align:-0.1944em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner">â‹¯</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">1</span><span class="mspace">Â </span><span class="mord text"><span class="mord textbf">do</span></span></span></span></span> ï¼ˆåå‘å»å™ªï¼‰</li></ul></li><li><p>é¢„æµ‹ï¼š<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo stretchy="false">[</mo><msub><mover accent="true"><mi>x</mi><mo>^</mo></mover><mn>0</mn></msub><mo separator="true">,</mo><msub><mover accent="true"><mi>v</mi><mo>^</mo></mover><mn>0</mn></msub><mo stretchy="false">]</mo><mo>=</mo><msub><mi>Ï•</mi><mi>Î¸</mi></msub><mo stretchy="false">(</mo><mo stretchy="false">[</mo><mi>x</mi><mi>t</mi><mo separator="true">,</mo><mi>v</mi><mi>t</mi><mo stretchy="false">]</mo><mo separator="true">,</mo><mi>t</mi><mo separator="true">,</mo><mi mathvariant="script">P</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">[\\hat{x}_0,\\hat{v}_0]=\\phi_\\theta([xt, vt], t, \\mathcal{P})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mopen">[</span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">x</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">]</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">Ï•</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">Î¸</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">([</span><span class="mord mathnormal">x</span><span class="mord mathnormal">t</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="mord mathnormal">t</span><span class="mclose">]</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal">t</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathcal" style="margin-right:0.08222em;">P</span><span class="mclose">)</span></span></span></span> ï¼Œé¢„æµ‹æ‰°åŠ¨ä½ç½®å’Œç±»å‹ï¼Œå³ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>x</mi><mo>^</mo></mover><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">\\hat{x}_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">x</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> Â å’Œ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mover accent="true"><mi>v</mi><mo>^</mo></mover><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">\\hat{v}_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> ï¼Œæ¡ä»¶æ˜¯å½“å‰çš„ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">x_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ã€<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>v</mi><mi>t</mi></msub></mrow><annotation encoding="application/x-tex">v_t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.5806em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>ã€æ—¶é—´æ­¥ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6151em;"></span><span class="mord mathnormal">t</span></span></span></span> å’Œè›‹ç™½è´¨ä¿¡æ¯ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="script">P</mi></mrow><annotation encoding="application/x-tex">\\mathcal{P}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathcal" style="margin-right:0.08222em;">P</span></span></span></span></p></li><li><p>æ ¹æ®åéªŒåˆ†å¸ƒ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>Î¸</mi></msub><mo stretchy="false">(</mo><msub><mi>x</mi><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mi mathvariant="normal">âˆ£</mi><msub><mi>x</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mover accent="true"><mi>x</mi><mo>^</mo></mover><mn>0</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p_\\theta(x_{t-1} | x_t, \\hat{x}_0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">Î¸</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mord">âˆ£</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal">x</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> å¯¹åŸå­ä½ç½® <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">x</mi><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\\mathbf{x}_{t-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6528em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathbf">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span>è¿›è¡Œé‡‡æ ·</p></li><li><p>æ ¹æ®åéªŒåˆ†å¸ƒ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>p</mi><mi>Î¸</mi></msub><mo stretchy="false">(</mo><msub><mi>v</mi><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub><mi mathvariant="normal">âˆ£</mi><msub><mi>v</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mover accent="true"><mi>v</mi><mo>^</mo></mover><mn>0</mn></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">p_\\theta(v_{t-1} | v_t, \\hat{v}_0)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">p</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">Î¸</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span><span class="mord">âˆ£</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2806em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">t</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.6944em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">v</span></span><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.2222em;"><span class="mord">^</span></span></span></span></span></span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> å¯¹åŸå­ç±»å‹ <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="bold">v</mi><mrow><mi>t</mi><mo>âˆ’</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">\\mathbf{v}_{t-1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6528em;vertical-align:-0.2083em;"></span><span class="mord"><span class="mord mathbf" style="margin-right:0.01597em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.016em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mbin mtight">âˆ’</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.2083em;"><span></span></span></span></span></span></span></span></span></span> è¿›è¡Œé‡‡æ ·</p></li></ol></div>',2)),l(t,{image:"https://image.velvet-notes.org/blog/sample_targetdiff.png",width:"85%",center:"true"}),i[3]||(i[3]=n(`<h2 id="targetdiff-ä»£ç " tabindex="-1"><a class="header-anchor" href="#targetdiff-ä»£ç "><span><strong>TargetDiff ä»£ç </strong></span></a></h2><h3 id="ä»£ç è§£è¯»" tabindex="-1"><a class="header-anchor" href="#ä»£ç è§£è¯»"><span><strong>ä»£ç è§£è¯»</strong></span></a></h3><p><a href="https://github.com/Velvet0314/targetdiff/tree/4LearnOnly" target="_blank" rel="noopener noreferrer">Velvet0314/targetdiff at 4LearnOnly</a></p><h3 id="ç¯å¢ƒå®‰è£…-tips" tabindex="-1"><a class="header-anchor" href="#ç¯å¢ƒå®‰è£…-tips"><span><strong>ç¯å¢ƒå®‰è£… Tips</strong></span></a></h3><ul><li>æ¨èåœ¨ Linux ä¸‹è¿›è¡Œç¯å¢ƒå®‰è£…ï¼ˆå¯ä»¥ç”¨ WSLï¼‰ â€”â€” Vina éœ€è¦ Linux ç¯å¢ƒ</li><li>æ³¨æ„ Pytorch, Cuda, Python çš„ç‰ˆæœ¬å¯¹åº”</li><li>éœ€è¦å®‰è£…å¯¹åº”ç‰ˆæœ¬çš„ cudatoolkit å®ç° Pytorch ä¸­åˆ©ç”¨ cuda è¿›è¡Œ GPU çš„åŠ é€Ÿ</li><li>æˆ‘çš„ç¯å¢ƒåœ¨ <code>myenvironment.yaml</code> ä¸­ï¼Œå¯ä»¥è·‘é€š</li></ul><h3 id="é¢å¤–å†…å®¹" tabindex="-1"><a class="header-anchor" href="#é¢å¤–å†…å®¹"><span><strong>é¢å¤–å†…å®¹</strong></span></a></h3><ul><li>test_cuda.py ç”¨äºæµ‹è¯• cuda æ˜¯å¦å¯ç”¨</li><li>viewlmdb.py ç”¨äºå¯è§†åŒ–è¾“å…¥æ•°æ®</li></ul><h3 id="è®­ç»ƒæµç¨‹" tabindex="-1"><a class="header-anchor" href="#è®­ç»ƒæµç¨‹"><span><strong>è®­ç»ƒæµç¨‹</strong></span></a></h3><p>ä¸»è¦ä»£ç åœ¨ <code>train_diffusion.py</code>å’Œ<code>molopt_score_model.py</code>ä¸­</p><div class="vp-steps"><ol><li><p>è§£æå‘½ä»¤è¡Œ â€”â€” è®­ç»ƒçš„è¶…å‚æ•°çš„è®¾ç½®</p></li><li><p>æ•°æ®çš„é¢„å¤„ç† â€”â€” æ•°æ®è¾“å…¥çš„é¢„å¤„ç†</p><ul><li>ä¸»è¦æ˜¯è¿›è¡Œæ•°æ®çš„æ˜ å°„ä¸åæ˜ å°„</li></ul></li><li><p>æ•°æ®é›†å¤„ç† â€”â€” æ•°æ®åŠ è½½ä¸åˆ’åˆ†</p></li><li><p>åˆå§‹åŒ–æ¨¡å‹ â€”â€” è°ƒç”¨<code>molopt_score_model.py</code>ä¸­çš„æ¨¡å‹</p></li><li><p>è®­ç»ƒ â€”â€” å…³é”®åœ¨ <code>model.get_diffusion_loss</code> å‡½æ•°ä¸­</p><div class="vp-steps"><ol><li>ç”Ÿæˆæ—¶é—´æ­¥ â€”â€” ç®—æ³•step2<div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#657B83;--shiki-dark:#839496;--shiki-light-bg:#FDF6E3;--shiki-dark-bg:#002B36;"><pre class="shiki shiki-themes solarized-light solarized-dark vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#93A1A1;--shiki-light-font-style:italic;--shiki-dark:#586E75;--shiki-dark-font-style:italic;"># sample noise levels</span></span>
<span class="line"><span style="--shiki-light:#859900;--shiki-dark:#859900;">if</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> time_step </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">is</span><span style="--shiki-light:#B58900;--shiki-dark:#B58900;"> None</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">:</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	time_step, pt </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#268BD2;--shiki-dark:#268BD2;"> self</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">.sample_time(num_graphs, protein_pos.device, </span><span style="--shiki-light:#268BD2;--shiki-dark:#268BD2;">self</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">.sample_time_method)</span></span>
<span class="line"><span style="--shiki-light:#859900;--shiki-dark:#859900;">else</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">:</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	pt </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> torch.ones_like(time_step).float() </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">/</span><span style="--shiki-light:#268BD2;--shiki-dark:#268BD2;"> self</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">.num_timesteps</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	a </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#268BD2;--shiki-dark:#268BD2;"> self</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">.alphas_cumprod.index_select(</span><span style="--shiki-light:#D33682;--shiki-dark:#D33682;">0</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">, time_step) Â </span><span style="--shiki-light:#93A1A1;--shiki-light-font-style:italic;--shiki-dark:#586E75;--shiki-dark-font-style:italic;"># (num_graphs, )</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li>è´¨å¿ƒå½’é›¶ â€”â€” ç®—æ³•step3<div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#657B83;--shiki-dark:#839496;--shiki-light-bg:#FDF6E3;--shiki-dark-bg:#002B36;"><pre class="shiki shiki-themes solarized-light solarized-dark vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">protein_pos, ligand_pos, _ </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> center_pos(</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	protein_pos, ligand_pos, batch_protein, batch_ligand, mode</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#268BD2;--shiki-dark:#268BD2;">self</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">.center_pos_mode)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li><li>å¯¹ åŸå­ä½ç½® pos &amp; åŸå­ç±»å‹ v è¿›è¡ŒåŠ å™ª â€”â€” ç®—æ³•step4&amp;5<div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#657B83;--shiki-dark:#839496;--shiki-light-bg:#FDF6E3;--shiki-dark-bg:#002B36;"><pre class="shiki shiki-themes solarized-light solarized-dark vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#93A1A1;--shiki-light-font-style:italic;--shiki-dark:#586E75;--shiki-dark-font-style:italic;"># perturb pos and v</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">a_pos </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> a[batch_ligand].unsqueeze(</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">-</span><span style="--shiki-light:#D33682;--shiki-dark:#D33682;">1</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">) Â </span><span style="--shiki-light:#93A1A1;--shiki-light-font-style:italic;--shiki-dark:#586E75;--shiki-dark-font-style:italic;"># (num_ligand_atoms, 1)</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">pos_noise </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> torch.zeros_like(ligand_pos)</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">pos_noise.normal_()</span></span>
<span class="line"><span style="--shiki-light:#93A1A1;--shiki-light-font-style:italic;--shiki-dark:#586E75;--shiki-dark-font-style:italic;"># Xt = a.sqrt() * X0 + (1-a).sqrt() * eps</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">ligand_pos_perturbed </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> a_pos.sqrt() </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">*</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> ligand_pos </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">+</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> (</span><span style="--shiki-light:#D33682;--shiki-dark:#D33682;">1.0</span><span style="--shiki-light:#859900;--shiki-dark:#859900;"> -</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> a_pos).sqrt() </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">*</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> pos_noise Â </span><span style="--shiki-light:#93A1A1;--shiki-light-font-style:italic;--shiki-dark:#586E75;--shiki-dark-font-style:italic;"># pos_noise * std</span></span>
<span class="line"><span style="--shiki-light:#93A1A1;--shiki-light-font-style:italic;--shiki-dark:#586E75;--shiki-dark-font-style:italic;"># Vt = a * V0 + (1-a) / K</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">log_ligand_v0 </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> index_to_log_onehot(ligand_v, </span><span style="--shiki-light:#268BD2;--shiki-dark:#268BD2;">self</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">.num_classes)</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">ligand_v_perturbed, log_ligand_vt </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#268BD2;--shiki-dark:#268BD2;"> self</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">.q_v_sample(log_ligand_v0, time_step, batch_ligand)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li>å‰å‘ä¼ æ’­è®¡ç®—ï¼Œå¾—åˆ°æ¯é˜¶æ®µåŠ å™ªçš„ç»“æœå’Œç½‘ç»œé¢„æµ‹çš„å™ªå£° â€”â€” ç®—æ³•step6<div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#657B83;--shiki-dark:#839496;--shiki-light-bg:#FDF6E3;--shiki-dark-bg:#002B36;"><pre class="shiki shiki-themes solarized-light solarized-dark vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#93A1A1;--shiki-light-font-style:italic;--shiki-dark:#586E75;--shiki-dark-font-style:italic;"># forward-pass NN, feed perturbed pos and v, output noise</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">preds </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#268BD2;--shiki-dark:#268BD2;"> self</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">(</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	protein_pos</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">protein_pos,</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	protein_v</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">protein_v,</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	batch_protein</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">batch_protein,</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	init_ligand_pos</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">ligand_pos_perturbed,</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	init_ligand_v</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">ligand_v_perturbed,</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	batch_ligand</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">batch_ligand,</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	time_step</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">time_step</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">pred_ligand_pos, pred_ligand_v </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> preds[</span><span style="--shiki-light:#2AA198;--shiki-dark:#2AA198;">&#39;pred_ligand_pos&#39;</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">], preds[</span><span style="--shiki-light:#2AA198;--shiki-dark:#2AA198;">&#39;pred_ligand_v&#39;</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#93A1A1;--shiki-light-font-style:italic;--shiki-dark:#586E75;--shiki-dark-font-style:italic;"># ç½‘ç»œé¢„æµ‹çš„å™ªå£°</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">pred_pos_noise </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> pred_ligand_pos </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">-</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> ligand_pos_perturbed</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#93A1A1;--shiki-light-font-style:italic;--shiki-dark:#586E75;--shiki-dark-font-style:italic;"># atom position</span></span>
<span class="line"><span style="--shiki-light:#859900;--shiki-dark:#859900;">if</span><span style="--shiki-light:#268BD2;--shiki-dark:#268BD2;"> self</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">.model_mean_type </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">==</span><span style="--shiki-light:#2AA198;--shiki-dark:#2AA198;"> &#39;noise&#39;</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">:</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	pos0_from_e </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#268BD2;--shiki-dark:#268BD2;"> self</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">._predict_x0_from_eps(</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">		xt</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">ligand_pos_perturbed, eps</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">pred_pos_noise, t</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">time_step, batch</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">batch_ligand)</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	pos_model_mean </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#268BD2;--shiki-dark:#268BD2;"> self</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">.q_pos_posterior(</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">		x0</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">pos0_from_e, xt</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">ligand_pos_perturbed, t</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">time_step, batch</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">batch_ligand)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#859900;--shiki-dark:#859900;">elif</span><span style="--shiki-light:#268BD2;--shiki-dark:#268BD2;"> self</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">.model_mean_type </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">==</span><span style="--shiki-light:#2AA198;--shiki-dark:#2AA198;"> &#39;C0&#39;</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">:</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	pos_model_mean </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#268BD2;--shiki-dark:#268BD2;"> self</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">.q_pos_posterior(</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">		x0</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">pred_ligand_pos, xt</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">ligand_pos_perturbed, t</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">time_step, batch</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">batch_ligand)</span></span>
<span class="line"><span style="--shiki-light:#859900;--shiki-dark:#859900;">else</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">:</span></span>
<span class="line"><span style="--shiki-light:#859900;--shiki-dark:#859900;">	raise</span><span style="--shiki-light:#CB4B16;--shiki-dark:#CB4B16;"> ValueError</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li>è®¡ç®—åéªŒåˆ†å¸ƒä¸è¯¯å·® â€”â€” ç®—æ³•step7&amp;8<div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#657B83;--shiki-dark:#839496;--shiki-light-bg:#FDF6E3;--shiki-dark-bg:#002B36;"><pre class="shiki shiki-themes solarized-light solarized-dark vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#93A1A1;--shiki-light-font-style:italic;--shiki-dark:#586E75;--shiki-dark-font-style:italic;"># atom pos loss</span></span>
<span class="line"><span style="--shiki-light:#859900;--shiki-dark:#859900;">if</span><span style="--shiki-light:#268BD2;--shiki-dark:#268BD2;"> self</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">.model_mean_type </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">==</span><span style="--shiki-light:#2AA198;--shiki-dark:#2AA198;"> &#39;C0&#39;</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">:</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	target, pred </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> ligand_pos, pred_ligand_pos</span></span>
<span class="line"><span style="--shiki-light:#859900;--shiki-dark:#859900;">elif</span><span style="--shiki-light:#268BD2;--shiki-dark:#268BD2;"> self</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">.model_mean_type </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">==</span><span style="--shiki-light:#2AA198;--shiki-dark:#2AA198;"> &#39;noise&#39;</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">:</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	target, pred </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> pos_noise, pred_pos_noise</span></span>
<span class="line"><span style="--shiki-light:#859900;--shiki-dark:#859900;">else</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">:</span></span>
<span class="line"><span style="--shiki-light:#859900;--shiki-dark:#859900;">	raise</span><span style="--shiki-light:#CB4B16;--shiki-dark:#CB4B16;"> ValueError</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">loss_pos </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> scatter_mean(((pred </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">-</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> target) </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">**</span><span style="--shiki-light:#D33682;--shiki-dark:#D33682;"> 2</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">).sum(</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">-</span><span style="--shiki-light:#D33682;--shiki-dark:#D33682;">1</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">), batch_ligand, dim</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#D33682;--shiki-dark:#D33682;">0</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">)</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">loss_pos </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> torch.mean(loss_pos)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#93A1A1;--shiki-light-font-style:italic;--shiki-dark:#586E75;--shiki-dark-font-style:italic;"># atom type loss</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">log_ligand_v_recon </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> F.log_softmax(pred_ligand_v, dim</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=-</span><span style="--shiki-light:#D33682;--shiki-dark:#D33682;">1</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">)</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">log_v_model_prob </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#268BD2;--shiki-dark:#268BD2;"> self</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">.q_v_posterior(log_ligand_v_recon, log_ligand_vt, time_step, batch_ligand)</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">log_v_true_prob </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#268BD2;--shiki-dark:#268BD2;"> self</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">.q_v_posterior(log_ligand_v0, log_ligand_vt, time_step, batch_ligand)</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">kl_v </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#268BD2;--shiki-dark:#268BD2;"> self</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">.compute_v_Lt(log_v_model_prob</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">log_v_model_prob, log_v0</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">log_ligand_v0,</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	log_v_true_prob</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">log_v_true_prob, t</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">time_step, batch</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">batch_ligand)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">loss_v </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> torch.mean(kl_v)</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">loss </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> loss_pos </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">+</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> loss_v </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">*</span><span style="--shiki-light:#268BD2;--shiki-dark:#268BD2;"> self</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">.loss_v_weight</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol></div></li></ol></div><h3 id="é‡‡æ ·æµç¨‹" tabindex="-1"><a class="header-anchor" href="#é‡‡æ ·æµç¨‹"><span><strong>é‡‡æ ·æµç¨‹</strong></span></a></h3><p>ä¸»è¦ä»£ç åœ¨ <code>sample_diffusion.py</code>å’Œ<code>molopt_score_model.py</code>ä¸­</p><div class="vp-steps"><ol><li><p>è§£æå‘½ä»¤è¡Œ â€”â€” é‡‡æ ·çš„è¶…å‚æ•°çš„è®¾ç½®</p></li><li><p>åŠ è½½è®­ç»ƒå¥½çš„æ¨¡å‹ â€”â€” ckpt -&gt; checkpoint</p></li><li><p>æ•°æ®çš„é¢„å¤„ç† â€”â€” é‡‡ç”¨å’Œæ¨¡å‹è®­ç»ƒæ—¶çš„ç›¸åŒçš„å¤„ç†ï¼ˆæ‰€æœ‰çš„ config å‡æ¥è‡ªäºé€‰å–çš„æ¨¡å‹çš„è®­ç»ƒæ—¶çš„é…ç½®ï¼‰</p></li><li><p>åˆå§‹åŒ–æ¨¡å‹ â€”â€” è°ƒç”¨<code>molopt_score_model.py</code>ä¸­çš„æ¨¡å‹</p></li><li><p>é‡‡æ · â€”â€” å…³é”®åœ¨ <code>sample_diffusion_ligand</code> å‡½æ•° å’Œ <code>model.sample_diffusion</code> å‡½æ•°ä¸­</p><div class="vp-steps"><ol><li>ç¡®å®šåŸå­æ•°é‡ â€”â€” ç®—æ³•step1<div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#657B83;--shiki-dark:#839496;--shiki-light-bg:#FDF6E3;--shiki-dark-bg:#002B36;"><pre class="shiki shiki-themes solarized-light solarized-dark vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#93A1A1;--shiki-light-font-style:italic;--shiki-dark:#586E75;--shiki-dark-font-style:italic;"># æ­¥éª¤ä¸€ï¼šç¡®å®šåŸå­æ•°é‡</span></span>
<span class="line"><span style="--shiki-light:#93A1A1;--shiki-light-font-style:italic;--shiki-dark:#586E75;--shiki-dark-font-style:italic;"># è¿™é‡Œæœ‰ä¸‰ç§æ–¹å¼ï¼Œå…¶ä¸­ç¬¬ä¸€ç§å¯¹åº”ç®—æ³•ä¸­çš„æ­¥éª¤</span></span>
<span class="line"><span style="--shiki-light:#859900;--shiki-dark:#859900;">if</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> sample_num_atoms </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">==</span><span style="--shiki-light:#2AA198;--shiki-dark:#2AA198;"> &#39;prior&#39;</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">:</span></span>
<span class="line"><span style="--shiki-light:#93A1A1;--shiki-light-font-style:italic;--shiki-dark:#586E75;--shiki-dark-font-style:italic;">	# æ ¹æ®å…ˆéªŒåˆ†å¸ƒé‡‡æ ·é…ä½“åŸå­æ•°é‡</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	pocket_size </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> atom_num.get_space_size(data.protein_pos.detach().cpu().numpy()) Â </span><span style="--shiki-light:#93A1A1;--shiki-light-font-style:italic;--shiki-dark:#586E75;--shiki-dark-font-style:italic;"># è®¡ç®—å£è¢‹å¤§å°</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	ligand_num_atoms </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> [atom_num.sample_atom_num(pocket_size).astype(</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">int</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">) </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">for</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> _ </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">in</span><span style="--shiki-light:#268BD2;--shiki-dark:#268BD2;"> range</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">(n_data)] Â </span><span style="--shiki-light:#93A1A1;--shiki-light-font-style:italic;--shiki-dark:#586E75;--shiki-dark-font-style:italic;"># é‡‡æ ·åŸå­æ•°é‡</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	batch_ligand </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> torch.repeat_interleave(torch.arange(n_data), torch.tensor(ligand_num_atoms)).to(device) Â </span><span style="--shiki-light:#93A1A1;--shiki-light-font-style:italic;--shiki-dark:#586E75;--shiki-dark-font-style:italic;"># ç”Ÿæˆé…ä½“æ‰¹æ¬¡ç´¢å¼•</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	</span></span>
<span class="line"><span style="--shiki-light:#859900;--shiki-dark:#859900;">elif</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> sample_num_atoms </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">==</span><span style="--shiki-light:#2AA198;--shiki-dark:#2AA198;"> &#39;range&#39;</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">:</span></span>
<span class="line"><span style="--shiki-light:#93A1A1;--shiki-light-font-style:italic;--shiki-dark:#586E75;--shiki-dark-font-style:italic;">	# æŒ‰é¡ºåºæŒ‡å®šé…ä½“åŸå­æ•°é‡</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	ligand_num_atoms </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#859900;--shiki-dark:#859900;"> list</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">(</span><span style="--shiki-light:#268BD2;--shiki-dark:#268BD2;">range</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">(current_i </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">+</span><span style="--shiki-light:#D33682;--shiki-dark:#D33682;"> 1</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">, current_i </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">+</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> n_data </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">+</span><span style="--shiki-light:#D33682;--shiki-dark:#D33682;"> 1</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">)) Â </span><span style="--shiki-light:#93A1A1;--shiki-light-font-style:italic;--shiki-dark:#586E75;--shiki-dark-font-style:italic;"># ç”ŸæˆåŸå­æ•°é‡åˆ—è¡¨</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	batch_ligand </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> torch.repeat_interleave(torch.arange(n_data), torch.tensor(ligand_num_atoms)).to(device) Â </span><span style="--shiki-light:#93A1A1;--shiki-light-font-style:italic;--shiki-dark:#586E75;--shiki-dark-font-style:italic;"># ç”Ÿæˆé…ä½“æ‰¹æ¬¡ç´¢å¼•</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	</span></span>
<span class="line"><span style="--shiki-light:#859900;--shiki-dark:#859900;">elif</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> sample_num_atoms </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">==</span><span style="--shiki-light:#2AA198;--shiki-dark:#2AA198;"> &#39;ref&#39;</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">:</span></span>
<span class="line"><span style="--shiki-light:#93A1A1;--shiki-light-font-style:italic;--shiki-dark:#586E75;--shiki-dark-font-style:italic;">	# ä½¿ç”¨å‚è€ƒæ•°æ®çš„åŸå­æ•°é‡</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	batch_ligand </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> batch.ligand_element_batch Â </span><span style="--shiki-light:#93A1A1;--shiki-light-font-style:italic;--shiki-dark:#586E75;--shiki-dark-font-style:italic;"># è·å–é…ä½“çš„æ‰¹æ¬¡ç´¢å¼•</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	ligand_num_atoms </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> scatter_sum(torch.ones_like(batch_ligand), batch_ligand, dim</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#D33682;--shiki-dark:#D33682;">0</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">).tolist() Â </span><span style="--shiki-light:#93A1A1;--shiki-light-font-style:italic;--shiki-dark:#586E75;--shiki-dark-font-style:italic;"># è®¡ç®—æ¯ä¸ªæ ·æœ¬çš„åŸå­æ•°é‡</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	Â  Â  </span></span>
<span class="line"><span style="--shiki-light:#859900;--shiki-dark:#859900;">else</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">:</span></span>
<span class="line"><span style="--shiki-light:#859900;--shiki-dark:#859900;">	raise</span><span style="--shiki-light:#CB4B16;--shiki-dark:#CB4B16;"> ValueError</span><span style="--shiki-light:#93A1A1;--shiki-light-font-style:italic;--shiki-dark:#586E75;--shiki-dark-font-style:italic;"> Â # æŠ›å‡ºå¼‚å¸¸</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li>è´¨å¿ƒå½’é›¶ â€”â€” ç®—æ³•step2<div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#657B83;--shiki-dark:#839496;--shiki-light-bg:#FDF6E3;--shiki-dark-bg:#002B36;"><pre class="shiki shiki-themes solarized-light solarized-dark vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#93A1A1;--shiki-light-font-style:italic;--shiki-dark:#586E75;--shiki-dark-font-style:italic;"># æ­¥éª¤äºŒï¼šåˆå§‹åŒ–é…ä½“ä½ç½®</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">center_pos </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> scatter_mean(batch.protein_pos, batch_protein, dim</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#D33682;--shiki-dark:#D33682;">0</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">) Â </span><span style="--shiki-light:#93A1A1;--shiki-light-font-style:italic;--shiki-dark:#586E75;--shiki-dark-font-style:italic;"># è®¡ç®—æ¯ä¸ªè›‹ç™½è´¨çš„ä¸­å¿ƒä½ç½®</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">batch_center_pos </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> center_pos[batch_ligand] Â </span><span style="--shiki-light:#93A1A1;--shiki-light-font-style:italic;--shiki-dark:#586E75;--shiki-dark-font-style:italic;"># è·å–æ¯ä¸ªé…ä½“åŸå­çš„ä¸­å¿ƒä½ç½®</span></span>
<span class="line"><span style="--shiki-light:#CB4B16;--shiki-dark:#CB4B16;">...</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">protein_pos, init_ligand_pos, offset </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> center_pos(</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	protein_pos, init_ligand_pos, batch_protein, batch_ligand, mode</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">center_pos_mode)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li>é‡‡æ ·åˆå§‹åŒ– â€”â€” ç®—æ³•step3<div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#657B83;--shiki-dark:#839496;--shiki-light-bg:#FDF6E3;--shiki-dark-bg:#002B36;"><pre class="shiki shiki-themes solarized-light solarized-dark vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#93A1A1;--shiki-light-font-style:italic;--shiki-dark:#586E75;--shiki-dark-font-style:italic;"># æ­¥éª¤ä¸‰ï¼šé‡‡æ ·åˆå§‹åŒ–â€”â€”åŸå­ä½ç½®</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">init_ligand_pos </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> batch_center_pos </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">+</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> torch.randn_like(batch_center_pos) Â </span><span style="--shiki-light:#93A1A1;--shiki-light-font-style:italic;--shiki-dark:#586E75;--shiki-dark-font-style:italic;"># æ·»åŠ éšæœºå™ªå£°ï¼Œåˆå§‹åŒ–é…ä½“ä½ç½®</span></span>
<span class="line"><span style="--shiki-light:#93A1A1;--shiki-light-font-style:italic;--shiki-dark:#586E75;--shiki-dark-font-style:italic;"># æ­¥éª¤ä¸‰ï¼šé‡‡æ ·åˆå§‹åŒ–â€”åŸå­ç±»å‹</span></span>
<span class="line"><span style="--shiki-light:#859900;--shiki-dark:#859900;">if</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> pos_only:</span></span>
<span class="line"><span style="--shiki-light:#93A1A1;--shiki-light-font-style:italic;--shiki-dark:#586E75;--shiki-dark-font-style:italic;">	# å¦‚æœä»…é‡‡æ ·ä½ç½®ï¼Œä½¿ç”¨åˆå§‹çš„é…ä½“ç‰¹å¾</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	init_ligand_v </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> batch.ligand_atom_feature_full</span></span>
<span class="line"><span style="--shiki-light:#859900;--shiki-dark:#859900;">else</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">:</span></span>
<span class="line"><span style="--shiki-light:#93A1A1;--shiki-light-font-style:italic;--shiki-dark:#586E75;--shiki-dark-font-style:italic;">	# å¦åˆ™ï¼Œä»å‡åŒ€åˆ†å¸ƒä¸­é‡‡æ ·åˆå§‹vå€¼</span></span>
<span class="line"><span style="--shiki-light:#93A1A1;--shiki-light-font-style:italic;--shiki-dark:#586E75;--shiki-dark-font-style:italic;">	# ç®—æ³•ä¸­å¯¹åº”çš„æ­¥éª¤</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	uniform_logits </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> torch.zeros(</span><span style="--shiki-light:#268BD2;--shiki-dark:#268BD2;">len</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">(batch_ligand), model.num_classes).to(device) Â </span><span style="--shiki-light:#93A1A1;--shiki-light-font-style:italic;--shiki-dark:#586E75;--shiki-dark-font-style:italic;"># åˆ›å»ºå‡åŒ€åˆ†å¸ƒçš„logits</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	init_ligand_v </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> log_sample_categorical(uniform_logits) Â </span><span style="--shiki-light:#93A1A1;--shiki-light-font-style:italic;--shiki-dark:#586E75;--shiki-dark-font-style:italic;"># é‡‡æ ·vå€¼</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li>åè½¬æ—¶é—´æ­¥ â€”â€” ç®—æ³•step4<div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#657B83;--shiki-dark:#839496;--shiki-light-bg:#FDF6E3;--shiki-dark-bg:#002B36;"><pre class="shiki shiki-themes solarized-light solarized-dark vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#93A1A1;--shiki-light-font-style:italic;--shiki-dark:#586E75;--shiki-dark-font-style:italic;"># time sequence</span></span>
<span class="line"><span style="--shiki-light:#93A1A1;--shiki-light-font-style:italic;--shiki-dark:#586E75;--shiki-dark-font-style:italic;"># åè½¬æ—¶é—´æ­¥ï¼Œä» T-1 åˆ° 0</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">time_seq </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#859900;--shiki-dark:#859900;"> list</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">(</span><span style="--shiki-light:#268BD2;--shiki-dark:#268BD2;">reversed</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">(</span><span style="--shiki-light:#268BD2;--shiki-dark:#268BD2;">range</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">(</span><span style="--shiki-light:#268BD2;--shiki-dark:#268BD2;">self</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">.num_timesteps </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">-</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> num_steps, </span><span style="--shiki-light:#268BD2;--shiki-dark:#268BD2;">self</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">.num_timesteps)))</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li>é¢„æµ‹ â€”â€” ç®—æ³•step5<div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#657B83;--shiki-dark:#839496;--shiki-light-bg:#FDF6E3;--shiki-dark-bg:#002B36;"><pre class="shiki shiki-themes solarized-light solarized-dark vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#93A1A1;--shiki-light-font-style:italic;--shiki-dark:#586E75;--shiki-dark-font-style:italic;"># æ­¥éª¤äº”ï¼šä»æ—¶é—´æ­¥ T å¼€å§‹ä½¿ç”¨æ¨¡å‹ Ï•â‚€ ä» [xâ‚œ, vâ‚œ] é¢„æµ‹ [xÌ‚â‚€, vÌ‚â‚€]</span></span>
<span class="line"><span style="--shiki-light:#93A1A1;--shiki-light-font-style:italic;--shiki-dark:#586E75;--shiki-dark-font-style:italic;"># self() è°ƒç”¨å‰å‘ä¼ æ’­ forward()</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">preds </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#268BD2;--shiki-dark:#268BD2;"> self</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">(</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	protein_pos</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">protein_pos,</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	protein_v</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">protein_v,</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	batch_protein</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">batch_protein,</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	init_ligand_pos</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">ligand_pos,</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	init_ligand_v</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">ligand_v,</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	batch_ligand</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">batch_ligand,</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	time_step</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">t</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#93A1A1;--shiki-light-font-style:italic;--shiki-dark:#586E75;--shiki-dark-font-style:italic;"># Compute posterior mean and variance</span></span>
<span class="line"><span style="--shiki-light:#859900;--shiki-dark:#859900;">if</span><span style="--shiki-light:#268BD2;--shiki-dark:#268BD2;"> self</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">.model_mean_type </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">==</span><span style="--shiki-light:#2AA198;--shiki-dark:#2AA198;"> &#39;noise&#39;</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">:</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	pred_pos_noise </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> preds[</span><span style="--shiki-light:#2AA198;--shiki-dark:#2AA198;">&#39;pred_ligand_pos&#39;</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">] </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">-</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> ligand_pos</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	pos0_from_e </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#268BD2;--shiki-dark:#268BD2;"> self</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">._predict_x0_from_eps(xt</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">ligand_pos, eps</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">pred_pos_noise, t</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">t, batch</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">batch_ligand)</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	v0_from_e </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> preds[</span><span style="--shiki-light:#2AA198;--shiki-dark:#2AA198;">&#39;pred_ligand_v&#39;</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">]</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	</span></span>
<span class="line"><span style="--shiki-light:#859900;--shiki-dark:#859900;">elif</span><span style="--shiki-light:#268BD2;--shiki-dark:#268BD2;"> self</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">.model_mean_type </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">==</span><span style="--shiki-light:#2AA198;--shiki-dark:#2AA198;"> &#39;C0&#39;</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	pos0_from_e </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> preds[</span><span style="--shiki-light:#2AA198;--shiki-dark:#2AA198;">&#39;pred_ligand_pos&#39;</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">]</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	v0_from_e </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> preds[</span><span style="--shiki-light:#2AA198;--shiki-dark:#2AA198;">&#39;pred_ligand_v&#39;</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">]</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	</span></span>
<span class="line"><span style="--shiki-light:#859900;--shiki-dark:#859900;">else</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">:</span></span>
<span class="line"><span style="--shiki-light:#859900;--shiki-dark:#859900;">	raise</span><span style="--shiki-light:#CB4B16;--shiki-dark:#CB4B16;"> ValueError</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li><li>é‡‡æ ·ä¸‹ä¸€æ—¶é—´æ­¥çš„ åŸå­ä½ç½® ä¸ åŸå­ç±»å‹ â€”â€” ç®—æ³•step6&amp;7<div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#657B83;--shiki-dark:#839496;--shiki-light-bg:#FDF6E3;--shiki-dark-bg:#002B36;"><pre class="shiki shiki-themes solarized-light solarized-dark vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#93A1A1;--shiki-light-font-style:italic;--shiki-dark:#586E75;--shiki-dark-font-style:italic;"># æ­¥éª¤å…­&amp;ä¸ƒï¼šç”±åéªŒåˆ†å¸ƒé‡‡æ · [xâ‚œâ‚‹â‚, vâ‚œâ‚‹â‚]</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">pos_model_mean </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#268BD2;--shiki-dark:#268BD2;"> self</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">.q_pos_posterior(x0</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">pos0_from_e, xt</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">ligand_pos, t</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">t, batch</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">batch_ligand)</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">pos_log_variance </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> extract(</span><span style="--shiki-light:#268BD2;--shiki-dark:#268BD2;">self</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">.posterior_logvar, t, batch_ligand)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#93A1A1;--shiki-light-font-style:italic;--shiki-dark:#586E75;--shiki-dark-font-style:italic;"># no noise when t == 0</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">nonzero_mask </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> (</span><span style="--shiki-light:#D33682;--shiki-dark:#D33682;">1</span><span style="--shiki-light:#859900;--shiki-dark:#859900;"> -</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> (t </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">==</span><span style="--shiki-light:#D33682;--shiki-dark:#D33682;"> 0</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">).float())[batch_ligand].unsqueeze(</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">-</span><span style="--shiki-light:#D33682;--shiki-dark:#D33682;">1</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">)</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">ligand_pos_next </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> pos_model_mean </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">+</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> nonzero_mask </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">*</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> (</span><span style="--shiki-light:#D33682;--shiki-dark:#D33682;">0.5</span><span style="--shiki-light:#859900;--shiki-dark:#859900;"> *</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> pos_log_variance).exp() </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">*</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> torch.randn_like(ligand_pos)</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">ligand_pos </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> ligand_pos_next</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#93A1A1;--shiki-light-font-style:italic;--shiki-dark:#586E75;--shiki-dark-font-style:italic;"># è‹¥ä¸åªæ˜¯é‡‡æ ·ä½ç½®ï¼Œåˆ™é‡‡æ ·åŸå­ç±»å‹ vâ‚œâ‚‹â‚</span></span>
<span class="line"><span style="--shiki-light:#859900;--shiki-dark:#859900;">if</span><span style="--shiki-light:#859900;--shiki-dark:#859900;"> not</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> pos_only:</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	log_ligand_v_recon </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> F.log_softmax(v0_from_e, dim</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=-</span><span style="--shiki-light:#D33682;--shiki-dark:#D33682;">1</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">)</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	log_ligand_v </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> index_to_log_onehot(ligand_v, </span><span style="--shiki-light:#268BD2;--shiki-dark:#268BD2;">self</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">.num_classes)</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	log_model_prob </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#268BD2;--shiki-dark:#268BD2;"> self</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">.q_v_posterior(log_ligand_v_recon, log_ligand_v, t, batch_ligand)</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	ligand_v_next </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> log_sample_categorical(log_model_prob)</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	v0_pred_traj.append(log_ligand_v_recon.clone().cpu())</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	vt_pred_traj.append(log_model_prob.clone().cpu())</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	ligand_v </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> ligand_v_next</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">ori_ligand_pos </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> ligand_pos </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">+</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> offset[batch_ligand]</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">pos_traj.append(ori_ligand_pos.clone().cpu())</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">v_traj.append(ligand_v.clone().cpu())</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div></li></ol></div></li></ol></div><h3 id="è¯„ä¼°æµç¨‹" tabindex="-1"><a class="header-anchor" href="#è¯„ä¼°æµç¨‹"><span><strong>è¯„ä¼°æµç¨‹</strong></span></a></h3><p>ä¸»è¦åœ¨<code>evaluate_diffusion.py</code> å’Œ <code>evaluate_from_meta.py</code> ä¸­</p><p>è¯„ä¼°æµç¨‹æ•´ä½“ä¸Šå°±æ˜¯å¯¹ä¸€äº›æŒ‡æ ‡è¿›è¡Œè®¡ç®—æ¥è¡¡é‡ç”Ÿæˆåˆ†å­çš„å¥½å</p><h4 id="jensen-shannon-divergence-between-the-distributions-of-bond-distance" tabindex="-1"><a class="header-anchor" href="#jensen-shannon-divergence-between-the-distributions-of-bond-distance"><span>Jensen-Shannon divergence between the distributions of bond distance</span></a></h4><p>ä¸»è¦åœ¨ <code>eval_bond_length.py</code> ä¸­</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#657B83;--shiki-dark:#839496;--shiki-light-bg:#FDF6E3;--shiki-dark-bg:#002B36;"><pre class="shiki shiki-themes solarized-light solarized-dark vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#586E75;--shiki-light-font-weight:bold;--shiki-dark:#93A1A1;--shiki-dark-font-weight:bold;">def</span><span style="--shiki-light:#268BD2;--shiki-dark:#268BD2;"> bond_distance_from_mol</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">(mol):</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	Â  Â pos </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> mol.GetConformer().GetPositions()</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	pdist </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> pos[</span><span style="--shiki-light:#B58900;--shiki-dark:#B58900;">None</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">, :] </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">-</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> pos[:, </span><span style="--shiki-light:#B58900;--shiki-dark:#B58900;">None</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">]</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	pdist </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> np.sqrt(np.sum(pdist </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">**</span><span style="--shiki-light:#D33682;--shiki-dark:#D33682;"> 2</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">, axis</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=-</span><span style="--shiki-light:#D33682;--shiki-dark:#D33682;">1</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">))</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	all_distances </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> []</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	</span></span>
<span class="line"><span style="--shiki-light:#859900;--shiki-dark:#859900;">	for</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> bond </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">in</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> mol.GetBonds():</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">		s_sym </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> bond.GetBeginAtom().GetAtomicNum()</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">		e_sym </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> bond.GetEndAtom().GetAtomicNum()</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">		s_idx, e_idx </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> bond.GetBeginAtomIdx(), bond.GetEndAtomIdx()</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">		bond_type </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> utils_data.</span><span style="--shiki-light:#CB4B16;--shiki-dark:#CB4B16;">BOND_TYPES</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">[bond.GetBondType()]</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">		distance </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> pdist[s_idx, e_idx]</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">		all_distances.append(((s_sym, e_sym, bond_type), distance))</span></span>
<span class="line"><span style="--shiki-light:#859900;--shiki-dark:#859900;">	return</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> all_distances</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="distribution-for-distances-of-all-atom-and-carbon-carbon-pairs" tabindex="-1"><a class="header-anchor" href="#distribution-for-distances-of-all-atom-and-carbon-carbon-pairs"><span>Distribution for distances of all atom and carbon-carbon pairs</span></a></h4><p>ä¸»è¦åœ¨ <code>eval_bond_length.py</code> ä¸­</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#657B83;--shiki-dark:#839496;--shiki-light-bg:#FDF6E3;--shiki-dark-bg:#002B36;"><pre class="shiki shiki-themes solarized-light solarized-dark vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">c_bond_length_profile </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> eval_bond_length.get_bond_length_profile(all_bond_dist)</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">c_bond_length_dict </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> eval_bond_length.eval_bond_length_profile(c_bond_length_profile)</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">logger.info(</span><span style="--shiki-light:#2AA198;--shiki-dark:#2AA198;">&#39;JS bond distances of complete mols: &#39;</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">)</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">print_dict(c_bond_length_dict, logger)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">success_pair_length_profile </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> eval_bond_length.get_pair_length_profile(success_pair_dist)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">success_js_metrics </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> eval_bond_length.eval_pair_length_profile(success_pair_length_profile)</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">print_dict(success_js_metrics, logger)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">atom_type_js </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> eval_atom_type.eval_atom_type_distribution(success_atom_types)</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">logger.info(</span><span style="--shiki-light:#2AA198;--shiki-dark:#2AA198;">&#39;Atom type JS: </span><span style="--shiki-light:#CB4B16;--shiki-dark:#CB4B16;">%.4f</span><span style="--shiki-light:#2AA198;--shiki-dark:#2AA198;">&#39;</span><span style="--shiki-light:#859900;--shiki-dark:#859900;"> %</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> atom_type_js)</span></span>
<span class="line"><span style="--shiki-light:#CB4B16;--shiki-dark:#CB4B16;">...</span></span>
<span class="line"><span style="--shiki-light:#586E75;--shiki-light-font-weight:bold;--shiki-dark:#93A1A1;--shiki-dark-font-weight:bold;">def</span><span style="--shiki-light:#268BD2;--shiki-dark:#268BD2;"> eval_bond_length_profile</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">(bond_length_profile: BondLengthProfile) -&gt; Dict[</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">str</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">, Optional[</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">float</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">]]:</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	metrics </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> {}</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	</span></span>
<span class="line"><span style="--shiki-light:#93A1A1;--shiki-light-font-style:italic;--shiki-dark:#586E75;--shiki-dark-font-style:italic;">	# Jensen-Shannon distances</span></span>
<span class="line"><span style="--shiki-light:#859900;--shiki-dark:#859900;">	for</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> bond_type, gt_distribution </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">in</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> eval_bond_length_config.</span><span style="--shiki-light:#CB4B16;--shiki-dark:#CB4B16;">EMPIRICAL_DISTRIBUTIONS</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">.items():</span></span>
<span class="line"><span style="--shiki-light:#859900;--shiki-dark:#859900;">		if</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> bond_type </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">not</span><span style="--shiki-light:#859900;--shiki-dark:#859900;"> in</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> bond_length_profile:</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">			metrics[</span><span style="--shiki-light:#586E75;--shiki-light-font-weight:bold;--shiki-dark:#93A1A1;--shiki-dark-font-weight:bold;">f</span><span style="--shiki-light:#2AA198;--shiki-dark:#2AA198;">&#39;JSD_</span><span style="--shiki-light:#CB4B16;--shiki-dark:#CB4B16;">{</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">_bond_type_str(bond_type)</span><span style="--shiki-light:#CB4B16;--shiki-dark:#CB4B16;">}</span><span style="--shiki-light:#2AA198;--shiki-dark:#2AA198;">&#39;</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">] </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#B58900;--shiki-dark:#B58900;"> None</span></span>
<span class="line"><span style="--shiki-light:#859900;--shiki-dark:#859900;">		else</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">:</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">			metrics[</span><span style="--shiki-light:#586E75;--shiki-light-font-weight:bold;--shiki-dark:#93A1A1;--shiki-dark-font-weight:bold;">f</span><span style="--shiki-light:#2AA198;--shiki-dark:#2AA198;">&#39;JSD_</span><span style="--shiki-light:#CB4B16;--shiki-dark:#CB4B16;">{</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">_bond_type_str(bond_type)</span><span style="--shiki-light:#CB4B16;--shiki-dark:#CB4B16;">}</span><span style="--shiki-light:#2AA198;--shiki-dark:#2AA198;">&#39;</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">] </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> sci_spatial.distance.jensenshannon(gt_distribution,Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  bond_length_profile[bond_type])</span></span>
<span class="line"><span style="--shiki-light:#859900;--shiki-dark:#859900;">	return</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> metrics</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#586E75;--shiki-light-font-weight:bold;--shiki-dark:#93A1A1;--shiki-dark-font-weight:bold;">def</span><span style="--shiki-light:#268BD2;--shiki-dark:#268BD2;"> eval_pair_length_profile</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">(pair_length_profile):</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	metrics </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> {}</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	</span></span>
<span class="line"><span style="--shiki-light:#859900;--shiki-dark:#859900;">	for</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> k, gt_distribution </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">in</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> eval_bond_length_config.</span><span style="--shiki-light:#CB4B16;--shiki-dark:#CB4B16;">PAIR_EMPIRICAL_DISTRIBUTIONS</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">.items():</span></span>
<span class="line"><span style="--shiki-light:#859900;--shiki-dark:#859900;">		if</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> k </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">not</span><span style="--shiki-light:#859900;--shiki-dark:#859900;"> in</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> pair_length_profile:</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">			metrics[</span><span style="--shiki-light:#586E75;--shiki-light-font-weight:bold;--shiki-dark:#93A1A1;--shiki-dark-font-weight:bold;">f</span><span style="--shiki-light:#2AA198;--shiki-dark:#2AA198;">&#39;JSD_</span><span style="--shiki-light:#CB4B16;--shiki-dark:#CB4B16;">{</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">k</span><span style="--shiki-light:#CB4B16;--shiki-dark:#CB4B16;">}</span><span style="--shiki-light:#2AA198;--shiki-dark:#2AA198;">&#39;</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">] </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#B58900;--shiki-dark:#B58900;"> None</span></span>
<span class="line"><span style="--shiki-light:#859900;--shiki-dark:#859900;">		else</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">:</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">			metrics[</span><span style="--shiki-light:#586E75;--shiki-light-font-weight:bold;--shiki-dark:#93A1A1;--shiki-dark-font-weight:bold;">f</span><span style="--shiki-light:#2AA198;--shiki-dark:#2AA198;">&#39;JSD_</span><span style="--shiki-light:#CB4B16;--shiki-dark:#CB4B16;">{</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">k</span><span style="--shiki-light:#CB4B16;--shiki-dark:#CB4B16;">}</span><span style="--shiki-light:#2AA198;--shiki-dark:#2AA198;">&#39;</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">] </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> sci_spatial.distance.jensenshannon(gt_distribution, pair_length_profile[k])</span></span>
<span class="line"><span style="--shiki-light:#859900;--shiki-dark:#859900;">	return</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> metrics</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#586E75;--shiki-light-font-weight:bold;--shiki-dark:#93A1A1;--shiki-dark-font-weight:bold;">def</span><span style="--shiki-light:#268BD2;--shiki-dark:#268BD2;"> eval_atom_type_distribution</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">(pred_counter: Counter):</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	total_num_atoms </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#268BD2;--shiki-dark:#268BD2;"> sum</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">(pred_counter.values())</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	pred_atom_distribution </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> {}</span></span>
<span class="line"><span style="--shiki-light:#859900;--shiki-dark:#859900;">	for</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> k </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">in</span><span style="--shiki-light:#CB4B16;--shiki-dark:#CB4B16;"> ATOM_TYPE_DISTRIBUTION</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">:</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">		pred_atom_distribution[k] </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> pred_counter[k] </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">/</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> total_num_atoms</span></span>
<span class="line"><span style="--shiki-light:#93A1A1;--shiki-light-font-style:italic;--shiki-dark:#586E75;--shiki-dark-font-style:italic;">	# print(&#39;pred atom distribution: &#39;, pred_atom_distribution)</span></span>
<span class="line"><span style="--shiki-light:#93A1A1;--shiki-light-font-style:italic;--shiki-dark:#586E75;--shiki-dark-font-style:italic;">	# print(&#39;ref Â atom distribution: &#39;, ATOM_TYPE_DISTRIBUTION)</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	js </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> sci_spatial.distance.jensenshannon(np.array(</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">list</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">(</span><span style="--shiki-light:#CB4B16;--shiki-dark:#CB4B16;">ATOM_TYPE_DISTRIBUTION</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">.values())),</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">												np.array(</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">list</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">(pred_atom_distribution.values())))</span></span>
<span class="line"><span style="--shiki-light:#859900;--shiki-dark:#859900;">	return</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> js</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="percentage-of-different-ring-sizes" tabindex="-1"><a class="header-anchor" href="#percentage-of-different-ring-sizes"><span>Percentage of different ring sizes</span></a></h4><p>ä¸»è¦åœ¨ <code>evaluate_diffusion.py</code> ä¸­</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#657B83;--shiki-dark:#839496;--shiki-light-bg:#FDF6E3;--shiki-dark-bg:#002B36;"><pre class="shiki shiki-themes solarized-light solarized-dark vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#586E75;--shiki-light-font-weight:bold;--shiki-dark:#93A1A1;--shiki-dark-font-weight:bold;">def</span><span style="--shiki-light:#268BD2;--shiki-dark:#268BD2;"> print_ring_ratio</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">(all_ring_sizes, logger):</span></span>
<span class="line"><span style="--shiki-light:#859900;--shiki-dark:#859900;">	for</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> ring_size </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">in</span><span style="--shiki-light:#268BD2;--shiki-dark:#268BD2;"> range</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">(</span><span style="--shiki-light:#D33682;--shiki-dark:#D33682;">3</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">, </span><span style="--shiki-light:#D33682;--shiki-dark:#D33682;">10</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">):</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">		n_mol </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#D33682;--shiki-dark:#D33682;"> 0</span></span>
<span class="line"><span style="--shiki-light:#859900;--shiki-dark:#859900;">		for</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> counter </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">in</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> all_ring_sizes:</span></span>
<span class="line"><span style="--shiki-light:#859900;--shiki-dark:#859900;">			if</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> ring_size </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">in</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> counter:</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">				n_mol </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">+=</span><span style="--shiki-light:#D33682;--shiki-dark:#D33682;"> 1</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">		logger.info(</span><span style="--shiki-light:#586E75;--shiki-light-font-weight:bold;--shiki-dark:#93A1A1;--shiki-dark-font-weight:bold;">f</span><span style="--shiki-light:#2AA198;--shiki-dark:#2AA198;">&#39;ring size: </span><span style="--shiki-light:#CB4B16;--shiki-dark:#CB4B16;">{</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">ring_size</span><span style="--shiki-light:#CB4B16;--shiki-dark:#CB4B16;">}</span><span style="--shiki-light:#2AA198;--shiki-dark:#2AA198;"> ratio: </span><span style="--shiki-light:#CB4B16;--shiki-dark:#CB4B16;">{</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">n_mol </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">/</span><span style="--shiki-light:#268BD2;--shiki-dark:#268BD2;"> len</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">(all_ring_sizes)</span><span style="--shiki-light:#586E75;--shiki-light-font-weight:bold;--shiki-dark:#93A1A1;--shiki-dark-font-weight:bold;">:.3f</span><span style="--shiki-light:#CB4B16;--shiki-dark:#CB4B16;">}</span><span style="--shiki-light:#2AA198;--shiki-dark:#2AA198;">&#39;</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#93A1A1;--shiki-light-font-style:italic;--shiki-dark:#586E75;--shiki-dark-font-style:italic;"># check ring distribution</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">print_ring_ratio([r[</span><span style="--shiki-light:#2AA198;--shiki-dark:#2AA198;">&#39;chem_results&#39;</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">][</span><span style="--shiki-light:#2AA198;--shiki-dark:#2AA198;">&#39;ring_size&#39;</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">] </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">for</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> r </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">in</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> results], logger)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="high-affinity" tabindex="-1"><a class="header-anchor" href="#high-affinity"><span>High Affinity</span></a></h4><p>ä¸»è¦åœ¨ <code>docking_vina.py</code>. å’Œ <code>docking_qvina.py</code> ä¸­</p><h5 id="docking-mode-çš„é€‰æ‹©" tabindex="-1"><a class="header-anchor" href="#docking-mode-çš„é€‰æ‹©"><span><code>docking_mode</code> <strong>çš„é€‰æ‹©</strong></span></a></h5><ul><li><p><code>evaluation_from_meta.py</code><code>docking_mode</code> æ˜¯é»˜è®¤çš„ <code>vina_full</code> æ¨¡å¼ï¼š</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#657B83;--shiki-dark:#839496;--shiki-light-bg:#FDF6E3;--shiki-dark-bg:#002B36;"><pre class="shiki shiki-themes solarized-light solarized-dark vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">parser.add_argument(</span><span style="--shiki-light:#2AA198;--shiki-dark:#2AA198;">&#39;--docking_mode&#39;</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">, type</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=str</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">, default</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#2AA198;--shiki-dark:#2AA198;">&#39;vina_full&#39;</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">,</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">					choices</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">[</span><span style="--shiki-light:#2AA198;--shiki-dark:#2AA198;">&#39;none&#39;</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">, </span><span style="--shiki-light:#2AA198;--shiki-dark:#2AA198;">&#39;qvina&#39;</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">, </span><span style="--shiki-light:#2AA198;--shiki-dark:#2AA198;">&#39;vina&#39;</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">, </span><span style="--shiki-light:#2AA198;--shiki-dark:#2AA198;">&#39;vina_full&#39;</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">, </span><span style="--shiki-light:#2AA198;--shiki-dark:#2AA198;">&#39;vina_score&#39;</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">])</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div></li><li><p><code>evaluation_diffusion.py</code> å–å†³äºå‘½ä»¤è¡Œé‡Œçš„å‚æ•°ï¼š</p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#657B83;--shiki-dark:#839496;--shiki-light-bg:#FDF6E3;--shiki-dark-bg:#002B36;"><pre class="shiki shiki-themes solarized-light solarized-dark vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">parser.add_argument(</span><span style="--shiki-light:#2AA198;--shiki-dark:#2AA198;">&#39;--docking_mode&#39;</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">, type</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=str</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">, default</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#2AA198;--shiki-dark:#2AA198;">&#39;vina_full&#39;</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">,</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">					choices</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">[</span><span style="--shiki-light:#2AA198;--shiki-dark:#2AA198;">&#39;qvina&#39;</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">, </span><span style="--shiki-light:#2AA198;--shiki-dark:#2AA198;">&#39;vina_score&#39;</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">, </span><span style="--shiki-light:#2AA198;--shiki-dark:#2AA198;">&#39;vina_dock&#39;</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">, </span><span style="--shiki-light:#2AA198;--shiki-dark:#2AA198;">&#39;none&#39;</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">])</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div></div></div><p>å‚è€ƒçš„å‘½ä»¤è¡Œï¼š</p><div class="language-bash line-numbers-mode" data-highlighter="shiki" data-ext="bash" style="--shiki-light:#657B83;--shiki-dark:#839496;--shiki-light-bg:#FDF6E3;--shiki-dark-bg:#002B36;"><pre class="shiki shiki-themes solarized-light solarized-dark vp-code"><code class="language-bash"><span class="line"><span style="--shiki-light:#268BD2;--shiki-dark:#268BD2;">python</span><span style="--shiki-light:#2AA198;--shiki-dark:#2AA198;"> scripts/evaluate_diffusion.py</span><span style="--shiki-light:#2AA198;--shiki-dark:#2AA198;"> {OUTPUT_DIR}</span><span style="--shiki-light:#CB4B16;--shiki-dark:#CB4B16;"> --docking_mode</span><span style="--shiki-light:#2AA198;--shiki-dark:#2AA198;"> vina_score</span><span style="--shiki-light:#CB4B16;--shiki-dark:#CB4B16;"> --protein_root</span><span style="--shiki-light:#2AA198;--shiki-dark:#2AA198;"> data/test_set</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div></div></div></li></ul><h5 id="affinity-çš„è®¡ç®—" tabindex="-1"><a class="header-anchor" href="#affinity-çš„è®¡ç®—"><span><strong>Affinity çš„è®¡ç®—</strong></span></a></h5><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#657B83;--shiki-dark:#839496;--shiki-light-bg:#FDF6E3;--shiki-dark-bg:#002B36;"><pre class="shiki shiki-themes solarized-light solarized-dark vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#586E75;--shiki-light-font-weight:bold;--shiki-dark:#93A1A1;--shiki-dark-font-weight:bold;">def</span><span style="--shiki-light:#268BD2;--shiki-dark:#268BD2;"> run</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">(self, mode</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#2AA198;--shiki-dark:#2AA198;">&#39;dock&#39;</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">, exhaustiveness</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#D33682;--shiki-dark:#D33682;">8</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">, </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">**</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">kwargs):</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">  		</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">  	ligand_pdbqt </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#268BD2;--shiki-dark:#268BD2;"> self</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">.ligand_path[:</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">-</span><span style="--shiki-light:#D33682;--shiki-dark:#D33682;">4</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">] </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">+</span><span style="--shiki-light:#2AA198;--shiki-dark:#2AA198;"> &#39;.pdbqt&#39;</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">  	protein_pqr </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#268BD2;--shiki-dark:#268BD2;"> self</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">.receptor_path[:</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">-</span><span style="--shiki-light:#D33682;--shiki-dark:#D33682;">4</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">] </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">+</span><span style="--shiki-light:#2AA198;--shiki-dark:#2AA198;"> &#39;.pqr&#39;</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">  	protein_pdbqt </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#268BD2;--shiki-dark:#268BD2;"> self</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">.receptor_path[:</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">-</span><span style="--shiki-light:#D33682;--shiki-dark:#D33682;">4</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">] </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">+</span><span style="--shiki-light:#2AA198;--shiki-dark:#2AA198;"> &#39;.pdbqt&#39;</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">  	</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">  	lig </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> PrepLig(</span><span style="--shiki-light:#268BD2;--shiki-dark:#268BD2;">self</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">.ligand_path, </span><span style="--shiki-light:#2AA198;--shiki-dark:#2AA198;">&#39;sdf&#39;</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">)</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">  	lig.get_pdbqt(ligand_pdbqt)</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">  	</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">  	prot </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> PrepProt(</span><span style="--shiki-light:#268BD2;--shiki-dark:#268BD2;">self</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">.receptor_path)</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">  	</span></span>
<span class="line"><span style="--shiki-light:#859900;--shiki-dark:#859900;">  	if</span><span style="--shiki-light:#859900;--shiki-dark:#859900;"> not</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> os.path.exists(protein_pqr):</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">  		prot.addH(protein_pqr)</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">  		</span></span>
<span class="line"><span style="--shiki-light:#859900;--shiki-dark:#859900;">  	if</span><span style="--shiki-light:#859900;--shiki-dark:#859900;"> not</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> os.path.exists(protein_pdbqt):</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">  		prot.get_pdbqt(protein_pdbqt)</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">  Â  Â  </span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">  	dock </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> VinaDock(ligand_pdbqt, protein_pdbqt)</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">  	dock.pocket_center, dock.box_size </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#268BD2;--shiki-dark:#268BD2;"> self</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">.center, [</span><span style="--shiki-light:#268BD2;--shiki-dark:#268BD2;">self</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">.size_x, </span><span style="--shiki-light:#268BD2;--shiki-dark:#268BD2;">self</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">.size_y, </span><span style="--shiki-light:#268BD2;--shiki-dark:#268BD2;">self</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">.size_z]</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">  	score, pose </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> dock.dock(score_func</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#2AA198;--shiki-dark:#2AA198;">&#39;vina&#39;</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">, mode</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">mode, exhaustiveness</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">exhaustiveness, save_pose</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#B58900;--shiki-dark:#B58900;">True</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">, </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">**</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">kwargs)</span></span>
<span class="line"><span style="--shiki-light:#859900;--shiki-dark:#859900;">  	return</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> [{</span><span style="--shiki-light:#2AA198;--shiki-dark:#2AA198;">&#39;affinity&#39;</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">: score, </span><span style="--shiki-light:#2AA198;--shiki-dark:#2AA198;">&#39;pose&#39;</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">: pose}]</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h4 id="diversity" tabindex="-1"><a class="header-anchor" href="#diversity"><span><strong>Diversity</strong></span></a></h4><p>TargetDiff ä¸­æ— è¯¥éƒ¨åˆ†ä»£ç ï¼Œä½†æ˜¯å•ç‹¬ç»™å‡ºä¸€ä¸ªç”¨äºè®¡ç®— Diversity çš„æ ‡å‡†ä»£ç </p><div class="language-python line-numbers-mode" data-highlighter="shiki" data-ext="python" style="--shiki-light:#657B83;--shiki-dark:#839496;--shiki-light-bg:#FDF6E3;--shiki-dark-bg:#002B36;"><pre class="shiki shiki-themes solarized-light solarized-dark vp-code"><code class="language-python"><span class="line"><span style="--shiki-light:#586E75;--shiki-light-font-weight:bold;--shiki-dark:#93A1A1;--shiki-dark-font-weight:bold;">def</span><span style="--shiki-light:#268BD2;--shiki-dark:#268BD2;"> tanimoto_sim</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">(mol, ref):</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	fp1 </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> Chem.RDKFingerprint(ref)</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	fp2 </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> Chem.RDKFingerprint(mol)</span></span>
<span class="line"><span style="--shiki-light:#859900;--shiki-dark:#859900;">	return</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> DataStructs.TanimotoSimilarity(fp1,fp2)</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	</span></span>
<span class="line"><span style="--shiki-light:#586E75;--shiki-light-font-weight:bold;--shiki-dark:#93A1A1;--shiki-dark-font-weight:bold;">def</span><span style="--shiki-light:#268BD2;--shiki-dark:#268BD2;"> calc_pairwise_sim</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">(mols):</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	n </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#268BD2;--shiki-dark:#268BD2;"> len</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">(mols)</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	sims </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> []</span></span>
<span class="line"><span style="--shiki-light:#859900;--shiki-dark:#859900;">	Â for</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> i </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">in</span><span style="--shiki-light:#268BD2;--shiki-dark:#268BD2;"> range</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">(n):</span></span>
<span class="line"><span style="--shiki-light:#859900;--shiki-dark:#859900;">		for</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> j </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">in</span><span style="--shiki-light:#268BD2;--shiki-dark:#268BD2;"> range</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">(i </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">+</span><span style="--shiki-light:#D33682;--shiki-dark:#D33682;"> 1</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">, n):</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">			sims.append(tanimoto_sim(mols[i], mols[j]))</span></span>
<span class="line"><span style="--shiki-light:#859900;--shiki-dark:#859900;">	return</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> np.array(sims)</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	</span></span>
<span class="line"><span style="--shiki-light:#586E75;--shiki-light-font-weight:bold;--shiki-dark:#93A1A1;--shiki-dark-font-weight:bold;">def</span><span style="--shiki-light:#268BD2;--shiki-dark:#268BD2;"> computer_diversity</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">(mols):</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	div_all </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> []</span></span>
<span class="line"><span style="--shiki-light:#93A1A1;--shiki-light-font-style:italic;--shiki-dark:#586E75;--shiki-dark-font-style:italic;">	# for result in tqdm(results):</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	div_all.append(np.mean(</span><span style="--shiki-light:#D33682;--shiki-dark:#D33682;">1</span><span style="--shiki-light:#859900;--shiki-dark:#859900;"> -</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> calc_pairwise_sim(mols)))</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	div_all </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> np.array(div_all)</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	div_all </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> div_all[</span><span style="--shiki-light:#859900;--shiki-dark:#859900;">~</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">np.isnan(div_all)]</span></span>
<span class="line"><span style="--shiki-light:#859900;--shiki-dark:#859900;">	return</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> div_all</span></span>
<span class="line"><span style="--shiki-light:#CB4B16;--shiki-dark:#CB4B16;">...</span></span>
<span class="line"><span style="--shiki-light:#859900;--shiki-dark:#859900;">for</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> ligand_filename, smiles_list </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">in</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> protein_ligand_dict.items():</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	diversity </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> computer_diversity(smiles_list)</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">	protein_diversities.append(diversity)</span></span>
<span class="line"><span style="--shiki-light:#268BD2;--shiki-dark:#268BD2;">	print</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">(</span><span style="--shiki-light:#586E75;--shiki-light-font-weight:bold;--shiki-dark:#93A1A1;--shiki-dark-font-weight:bold;">f</span><span style="--shiki-light:#2AA198;--shiki-dark:#2AA198;">&quot;</span><span style="--shiki-light:#CB4B16;--shiki-dark:#CB4B16;">{</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">ligand_filename</span><span style="--shiki-light:#CB4B16;--shiki-dark:#CB4B16;">}</span><span style="--shiki-light:#2AA198;--shiki-dark:#2AA198;"> çš„diversity: </span><span style="--shiki-light:#CB4B16;--shiki-dark:#CB4B16;">{</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">diversity</span><span style="--shiki-light:#CB4B16;--shiki-dark:#CB4B16;">}</span><span style="--shiki-light:#2AA198;--shiki-dark:#2AA198;">&quot;</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">)</span></span>
<span class="line"><span style="--shiki-light:#268BD2;--shiki-dark:#268BD2;">print</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">(</span><span style="--shiki-light:#268BD2;--shiki-dark:#268BD2;">len</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;">(protein_ligand_dict))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">mean_diversity </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> np.mean(protein_diversities)</span></span>
<span class="line"><span style="--shiki-light:#657B83;--shiki-dark:#839496;">median_diversity </span><span style="--shiki-light:#859900;--shiki-dark:#859900;">=</span><span style="--shiki-light:#657B83;--shiki-dark:#839496;"> np.median(protein_diversities)</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,34))])}const g=e(k,[["render",m]]),o=JSON.parse('{"path":"/papers/%E5%88%86%E5%AD%90%E7%94%9F%E6%88%90/targetdiff","title":"TargetDiff","lang":"zh-CN","frontmatter":{"title":"TargetDiff","createTime":"2024/12/23 20:29:02","tags":["é…ä½“ç”Ÿæˆ","æ‰©æ•£æ¨¡å‹"],"permalink":"/papers/åˆ†å­ç”Ÿæˆ/targetdiff","prev":"/papers/åˆ†å­ç”Ÿæˆ/ipdiff","next":{},"description":"TargetDiff æ¦‚è¿° TargetDiff åœ¨å¹²ä»€ä¹ˆ TargetDiffæ˜¯ä¸€ç§åŸºäºä¸‰ç»´ç­‰å˜æ‰©æ•£æ¨¡å‹çš„åˆ†å­ç”Ÿæˆå·¥å…·ï¼Œä¸“æ³¨äºç›®æ ‡è›‹ç™½æ„ŸçŸ¥çš„åˆ†å­è®¾è®¡å’Œç»“åˆäº²å’ŒåŠ›é¢„æµ‹ï¼Œæ—¨åœ¨åŠ é€Ÿè¯ç‰©å‘ç°è¿›ç¨‹ã€‚å…¶æ ¸å¿ƒåº”ç”¨åŒ…æ‹¬ï¼š é¶å‘åˆ†å­ç”Ÿæˆï¼šæ ¹æ®ç›®æ ‡è›‹ç™½çš„ä¸‰ç»´ç»“åˆå£è¢‹ç»“æ„ï¼Œç”Ÿæˆä¸ä¹‹ç©ºé—´åŒ¹é…ä¸”å…·æœ‰é«˜ç»“åˆäº²å’ŒåŠ›çš„å€™é€‰åˆ†å­ï¼ˆä¾‹å¦‚å°åˆ†å­é…ä½“ï¼‰ ç»“åˆäº²å’ŒåŠ›é¢„æµ‹ï¼šé€šè¿‡æ— ç›‘ç£ç‰¹å¾æå–ï¼Œ...","head":[["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"TargetDiff\\",\\"image\\":[\\"\\"],\\"dateModified\\":\\"2025-05-23T11:04:23.000Z\\",\\"author\\":[]}"],["meta",{"property":"og:url","content":"https://velvet-notes.org/papers/%E5%88%86%E5%AD%90%E7%94%9F%E6%88%90/targetdiff"}],["meta",{"property":"og:site_name","content":"Velvet-Notes"}],["meta",{"property":"og:title","content":"TargetDiff"}],["meta",{"property":"og:description","content":"TargetDiff æ¦‚è¿° TargetDiff åœ¨å¹²ä»€ä¹ˆ TargetDiffæ˜¯ä¸€ç§åŸºäºä¸‰ç»´ç­‰å˜æ‰©æ•£æ¨¡å‹çš„åˆ†å­ç”Ÿæˆå·¥å…·ï¼Œä¸“æ³¨äºç›®æ ‡è›‹ç™½æ„ŸçŸ¥çš„åˆ†å­è®¾è®¡å’Œç»“åˆäº²å’ŒåŠ›é¢„æµ‹ï¼Œæ—¨åœ¨åŠ é€Ÿè¯ç‰©å‘ç°è¿›ç¨‹ã€‚å…¶æ ¸å¿ƒåº”ç”¨åŒ…æ‹¬ï¼š é¶å‘åˆ†å­ç”Ÿæˆï¼šæ ¹æ®ç›®æ ‡è›‹ç™½çš„ä¸‰ç»´ç»“åˆå£è¢‹ç»“æ„ï¼Œç”Ÿæˆä¸ä¹‹ç©ºé—´åŒ¹é…ä¸”å…·æœ‰é«˜ç»“åˆäº²å’ŒåŠ›çš„å€™é€‰åˆ†å­ï¼ˆä¾‹å¦‚å°åˆ†å­é…ä½“ï¼‰ ç»“åˆäº²å’ŒåŠ›é¢„æµ‹ï¼šé€šè¿‡æ— ç›‘ç£ç‰¹å¾æå–ï¼Œ..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"og:updated_time","content":"2025-05-23T11:04:23.000Z"}],["meta",{"property":"article:tag","content":"æ‰©æ•£æ¨¡å‹"}],["meta",{"property":"article:tag","content":"é…ä½“ç”Ÿæˆ"}],["meta",{"property":"article:modified_time","content":"2025-05-23T11:04:23.000Z"}]]},"readingTime":{"minutes":12.3,"words":3690},"git":{"createdTime":1734958097000,"updatedTime":1747998263000,"contributors":[{"name":"Velvet","username":"Velvet0314","email":"3131492575@qq.com","commits":10,"avatar":"https://image.velvet-notes.org/blog/avatar.png","url":"https://github.com/Velvet0314"}]},"autoDesc":true,"filePathRelative":"papers/åˆ†å­ç”Ÿæˆ/targetdiff.md","headers":[],"categoryList":[{"id":"a566b2","sort":10000,"name":"papers"},{"id":"c55bca","sort":10001,"name":"åˆ†å­ç”Ÿæˆ"}]}');export{g as comp,o as data};
